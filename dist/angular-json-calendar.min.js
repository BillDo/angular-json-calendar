!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("angular-json-calendar",[],t):"object"==typeof exports?exports["angular-json-calendar"]=t():e["angular-json-calendar"]=t()}(this,function(){return function(e){function t(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1),r=a(3),c=a(4),i=a(10),o=a(11),l=a(12);t["default"]=angular.module("bc.JsonCalendar",[]).provider("bcCalendarConfig",n.bcCalendarConfig).service("bcCalendarService",r.bcCalendarService).directive("bcCalendar",c.bcCalendarDirective).directive("bcMonth",i.bcMonthDirective).directive("bcWeek",o.bcWeekDirective).directive("bcDay",l.bcDayDirective)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.bcCalendarConfig=void 0;var c=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(2),o=n(i);t.bcCalendarConfig=function(){function e(){"ngInject";var t=this;r(this,e),this.startDate=moment(new Date).startOf("day").format(),this.nestingDepth="month",this.days=30,this.weekdayStyle={letter:["S","M","T","W","T","F","S"],abbreviation:["Sun","Mon","Tue","Wed","Thur","Fri","Sat"],word:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},this.dayTitleFormat="abbreviation",this.showWeekdays=!0,this.dayTemplate=o["default"],this.setDayTemplate=function(e){t.userDayTemplate=e},this.dateFormat="D",this.monthTitleFormat="MMMM",this.showMonthTitles=!0}return c(e,[{key:"$get",value:function(){return this}}]),e}()},function(e,t){var a="/Users/bc/Code/open-source/angular-json-calendar/src/templates/day.inner.html",n='<time datetime="{{ day.date | date:\'yyyy-MM-dd\' }}" class=bc-calendar__day-time title="{{ day.date }}" data-ng-if=day.date> <span data-ng-bind="$ctrl.formatDate(day.date, $ctrl.dateFormat)"></span> </time>';window.angular.module("ng").run(["$templateCache",function(e){e.put(a,n)}]),e.exports=a},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.bcCalendarService=function(){function e(){"ngInject";a(this,e),this.WEEK_LENGTH=7,this.dayTemplate}return n(e,[{key:"dateIsBeforeToday",value:function(e){var t=moment(new Date).startOf("day").format();return moment(e).isBefore(t)}},{key:"isDayToday",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?moment(new Date).format():arguments[1];return moment(e).isSame(t)}},{key:"integerToArray",value:function(e){var t=void 0,a=[];for(t=0;t<e;t+=1)a.push(t);return a}},{key:"padDaysLeft",value:function(e,t){var a=[],n=this.integerToArray(t);for(var r in n){var c=parseInt(r,10)+1,i=moment(e).subtract(c,"days").toISOString();a.unshift({date:i})}return a}},{key:"padBlankTiles",value:function(e,t){var a=arguments.length<=2||void 0===arguments[2]?"left":arguments[2],n=void 0,r=[];for(n=0;n<t;n+=1)r.push({date:null});return"right"===a?e.concat(r):"left"===a?r.concat(e):void 0}},{key:"chunk",value:function(e){for(var t=arguments.length<=1||void 0===arguments[1]?this.WEEK_LENGTH:arguments[1],a=[],n=0,r=e.length/parseInt(t,10);n<r;)a[n]=e.splice(0,t),n+=1;return a}},{key:"durationInDays",value:function(e,t){var a=moment(e).startOf("day"),n=moment(t).startOf("day").add(1,"days");return n.diff(a,"days")}},{key:"organizeWeeks",value:function(e){var t=moment(e[0].date).day(),a=moment(e[e.length-1].date).day(),n=6,r=0;return t>r&&(e=this.padBlankTiles(e,t,"left")),a<n&&(e=this.padBlankTiles(e,this.WEEK_LENGTH-(a+1),"right")),this.chunk(e)}},{key:"organizeMonths",value:function(e){var t=[],a=6,n=0,r=e,c=void 0,i=moment(r[0].date).date(),o=moment(r[0].date).daysInMonth();if(moment(r[0].date).date()>0){c=r.slice(0,o-(i-1));var l=this.padDaysLeft(c[0].date,i-1);r=l.concat(r)}for(;r.length>0;){i=moment(r[0].date).date(),o=moment(r[0].date).daysInMonth(),c=r.splice(0,o-(i-1));var d=moment(c[0].date).day();d>n&&(c=this.padBlankTiles(c,d,"left"));var s=moment(c[c.length-1].date).day();s<a&&(c=this.padBlankTiles(c,this.WEEK_LENGTH-(s+1),"right")),t.push(this.chunk(c))}return t}},{key:"buildDays",value:function(e){for(var t=arguments.length<=1||void 0===arguments[1]?new Date:arguments[1],a=0,n=[],r=void 0;a<e;)r=moment(t).add(a,"days").toISOString(),n.push({date:r}),a+=1;return n}},{key:"storeDayTemplate",value:function(e){this.dayTemplate=e}},{key:"getDayTemplate",value:function(){return this.dayTemplate}}]),e}()},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(){"ngInject";function e(e,a,n,r){r.getTemplateUrl=function(){return t[r.nestingDepth]}}var t={month:d["default"],week:u["default"],day:h["default"]},a={restrict:"E",scope:{},bindToController:{bcStartDate:"@?",bcEndDate:"@?",bcNestingDepth:"@?",bcDays:"@?",bcDayTitleFormat:"@?",bcMonthTitleFormat:"@?",bcDateSelected:"&",bcShowWeekdays:"=?",bcShowMonthTitles:"=?",bcDayTemplate:"@?",bcDateFormat:"@?"},link:e,templateUrl:o["default"],controller:c.CalendarController,controllerAs:"$ctrl"};return a}Object.defineProperty(t,"__esModule",{value:!0}),t.bcCalendarDirective=r;var c=a(5),i=a(6),o=n(i),l=a(7),d=n(l),s=a(8),u=n(s),y=a(9),h=n(y)},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.CalendarController=function(){function e(t,n,r){"ngInject";a(this,e),this.$templateCache=t,this.bcCalendarConfig=n,this.bcCalendarService=r,this._activate()}return e.$inject=["$templateCache","bcCalendarConfig","bcCalendarService"],n(e,[{key:"_activate",value:function(){if(this.today=moment(new Date).startOf("day"),this.startDate=this.bcStartDate||this.bcCalendarConfig.startDate,this.bcEndDate?this.days=this.bcCalendarService.durationInDays(this.startDate,this.bcEndDate):this.days=parseInt(this.bcDays||this.bcCalendarConfig.days,10),this.nestingDepth=this.bcNestingDepth||this.bcCalendarConfig.nestingDepth,this.weekdays=this.bcDayTitleFormat?this.bcCalendarConfig.weekdayStyle[this.bcDayTitleFormat]:this.bcCalendarConfig.weekdayStyle[this.bcCalendarConfig.dayTitleFormat],this.monthTitleFormat=this.bcMonthTitleFormat||this.bcCalendarConfig.monthTitleFormat,this.showMonthTitles="boolean"==typeof this.bcShowMonthTitles?this.bcShowMonthTitles:this.bcCalendarConfig.showMonthTitles,this.selectedDate=null,this.showWeekdays="boolean"==typeof this.bcShowWeekdays?this.bcShowWeekdays:this.bcCalendarConfig.showWeekdays,this.bcDayTemplate||this.bcCalendarConfig.userDayTemplate){var e="userDayTemplate.html";this.bcDayTemplate&&this.$templateCache.put(e,this.bcDayTemplate),this.bcCalendarConfig.userDayTemplate&&this.$templateCache.put(e,this.bcCalendarConfig.userDayTemplate),this.bcCalendarService.storeDayTemplate(e)}else this.bcCalendarService.storeDayTemplate(this.bcCalendarConfig.dayTemplate);this.dateFormat=this.bcDateFormat||this.bcCalendarConfig.dateFormat;var t=this.bcCalendarService.buildDays(this.days,this.startDate);this._buildCalendar(t,this.nestingDepth)}},{key:"isBeforeToday",value:function(e){return this.bcCalendarService.dateIsBeforeToday(e)}},{key:"isDayToday",value:function(e){return this.bcCalendarService.isDayToday(e,this.startDate)}},{key:"selectDate",value:function(e){this.selectedDate=e,e.date&&this.bcDateSelected&&this.bcDateSelected({date:e.date})}},{key:"formatDate",value:function(e,t){return!!e&&moment(e).format(t)}},{key:"_buildCalendar",value:function(e,t){"month"===t?this.bcCollection=this.bcCalendarService.organizeMonths(e):"week"===t?this.bcCollection=this.bcCalendarService.organizeWeeks(e):"day"===t&&(this.bcCollection=e)}}]),e}()},function(e,t){var a="/Users/bc/Code/open-source/angular-json-calendar/src/templates/calendar.html",n='<section class=bc-calendar> <span class=bc-calendar__weekdays data-ng-if="$ctrl.showWeekdays && $ctrl.nestingDepth === \'week\'"> <span class="bc-calendar__day bc-calendar__day--weekdays" data-ng-repeat="day in $ctrl.weekdays track by $index"> <strong class=bc-calendar__day-title> {{ day }} </strong> </span> </span> <bc-month data-ng-if="$ctrl.nestingDepth === \'month\'" class=bc-calendar__month-wrapper bc-collection=$ctrl.bcCollection></bc-month> <bc-week data-ng-if="$ctrl.nestingDepth === \'week\'" class=bc-calendar__week-wrapper bc-collection=$ctrl.bcCollection></bc-week> <bc-day data-ng-if="$ctrl.nestingDepth === \'day\'" class=bc-calendar__day-wrapper bc-collection=$ctrl.bcCollection></bc-day> </section>';window.angular.module("ng").run(["$templateCache",function(e){e.put(a,n)}]),e.exports=a},function(e,t){var a="/Users/bc/Code/open-source/angular-json-calendar/src/templates/month.html",n='<time class=bc-calendar__month datetime="{{ month[0][month[0].length - 1].date | date:\'yyyy-MM\' }}" data-ng-repeat="month in vm.bcCollection track by $index"> <span class=bc-calendar__month-title data-ng-bind="$ctrl.formatDate(month[0][month[0].length - 1].date, $ctrl.monthTitleFormat)" data-ng-if=$ctrl.showMonthTitles></span> <span class=bc-calendar__weekdays data-ng-if=$ctrl.showWeekdays> <span class="bc-calendar__day bc-calendar__day--weekdays" data-ng-repeat="day in $ctrl.weekdays track by $index"> <strong class=bc-calendar__day-title> {{ day }} </strong> </span> </span> <bc-week bc-collection=month class=bc-calendar__week-wrapper></bc-week> </time>';window.angular.module("ng").run(["$templateCache",function(e){e.put(a,n)}]),e.exports=a},function(e,t){var a="/Users/bc/Code/open-source/angular-json-calendar/src/templates/week.html",n='<time class=bc-calendar__week datetime="{{ week[week.length - 1].date | date:\'yyyy-ww\' }}" data-ng-repeat="week in vm.bcCollection track by $index"> <bc-day bc-collection=week class=bc-calendar__day-wrapper></bc-day> </time>';window.angular.module("ng").run(["$templateCache",function(e){e.put(a,n)}]),e.exports=a},function(e,t){var a="/Users/bc/Code/open-source/angular-json-calendar/src/templates/day.html",n="<span class=bc-calendar__day data-ng-class=\"{ 'bc-calendar__day--disabled': $ctrl.isBeforeToday(day.date),\n                   'bc-calendar__day--today': $ctrl.isDayToday(day.date),\n                   'bc-calendar__day--even': $even,\n                   'bc-calendar__day--odd': $odd,\n                   'bc-calendar__day--pad': !day.date,\n                   'bc-calendar__day--valid': day.date,\n                   'bc-calendar__day--selected': day.date === $ctrl.selectedDate.date }\" data-ng-click=$ctrl.selectDate(day) data-ng-repeat=\"day in vm.bcCollection track by $index\" title=\"{{ day.date ? day.date : '' }}\" tabindex=\"{{ day.date ? 1 : -1 }}\"> <ng-include src=vm.dayTemplate></ng-include> </span>";window.angular.module("ng").run(["$templateCache",function(e){e.put(a,n)}]),e.exports=a},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(){"ngInject";var e={restrict:"E",scope:!0,bindToController:{bcCollection:"=",bcWeekdaysHeader:"="},templateUrl:i["default"],controller:function(){},controllerAs:"vm"};return e}Object.defineProperty(t,"__esModule",{value:!0}),t.bcMonthDirective=r;var c=a(7),i=n(c)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(){"ngInject";var e={restrict:"E",scope:!0,bindToController:{bcCollection:"="},templateUrl:i["default"],controller:function(){},controllerAs:"vm"};return e}Object.defineProperty(t,"__esModule",{value:!0}),t.bcWeekDirective=r;var c=a(8),i=n(c)},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){"ngInject";var t={restrict:"E",scope:!0,bindToController:{bcCollection:"="},templateUrl:i["default"],controller:["bcCalendarService",function(e){this.dayTemplate=e.getDayTemplate()}],controllerAs:"vm"};return t}r.$inject=["bcCalendarConfig"],Object.defineProperty(t,"__esModule",{value:!0}),t.bcDayDirective=r;var c=a(9),i=n(c)}])});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uPzVjYTYiLCJ3ZWJwYWNrOi8vL2FuZ3VsYXItanNvbi1jYWxlbmRhci5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDIyM2FiMWJmZWQxNDZiZWI5YWIzPzc4NzgiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzPzk1NTIiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NhbGVuZGFyLnByb3ZpZGVyLmpzPzQ2YjAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RlbXBsYXRlcy9kYXkuaW5uZXIuaHRtbD9lYzZmIiwid2VicGFjazovLy8uL3NyYy9jYWxlbmRhci5zZXJ2aWNlLmpzPzI2MzkiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NhbGVuZGFyLmRpcmVjdGl2ZS5qcz8xNGU3Iiwid2VicGFjazovLy8uL3NyYy9jYWxlbmRhci5jb250cm9sbGVyLmpzPzNlYjgiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RlbXBsYXRlcy9jYWxlbmRhci5odG1sPzIxNDQiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RlbXBsYXRlcy9tb250aC5odG1sP2VmNjEiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RlbXBsYXRlcy93ZWVrLmh0bWw/NDgwNyIsIndlYnBhY2s6Ly8vLi9zcmMvdGVtcGxhdGVzL2RheS5odG1sPzkzMDYiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vbnRoLmRpcmVjdGl2ZS5qcz80ZDdkIiwid2VicGFjazovLy8uL3NyYy93ZWVrLmRpcmVjdGl2ZS5qcz9lYjVmIiwid2VicGFjazovLy8uL3NyYy9kYXkuZGlyZWN0aXZlLmpzP2EzYzEiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwidGhpcyIsIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsIl9jYWxlbmRhciIsIl9jYWxlbmRhcjIiLCJfY2FsZW5kYXIzIiwiX21vbnRoIiwiX3dlZWsiLCJfZGF5IiwiYW5ndWxhciIsInByb3ZpZGVyIiwiYmNDYWxlbmRhckNvbmZpZyIsInNlcnZpY2UiLCJiY0NhbGVuZGFyU2VydmljZSIsImRpcmVjdGl2ZSIsImJjQ2FsZW5kYXJEaXJlY3RpdmUiLCJiY01vbnRoRGlyZWN0aXZlIiwiYmNXZWVrRGlyZWN0aXZlIiwiYmNEYXlEaXJlY3RpdmUiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwidW5kZWZpbmVkIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJwcm90b3R5cGUiLCJfZGF5SW5uZXIiLCJfZGF5SW5uZXIyIiwiX3RoaXMiLCJzdGFydERhdGUiLCJtb21lbnQiLCJEYXRlIiwic3RhcnRPZiIsImZvcm1hdCIsIm5lc3RpbmdEZXB0aCIsImRheXMiLCJ3ZWVrZGF5U3R5bGUiLCJsZXR0ZXIiLCJhYmJyZXZpYXRpb24iLCJ3b3JkIiwiZGF5VGl0bGVGb3JtYXQiLCJzaG93V2Vla2RheXMiLCJkYXlUZW1wbGF0ZSIsInNldERheVRlbXBsYXRlIiwidGVtcGxhdGUiLCJ1c2VyRGF5VGVtcGxhdGUiLCJkYXRlRm9ybWF0IiwibW9udGhUaXRsZUZvcm1hdCIsInNob3dNb250aFRpdGxlcyIsInBhdGgiLCJodG1sIiwid2luZG93IiwicnVuIiwicHV0IiwiV0VFS19MRU5HVEgiLCJkYXRlIiwidG9kYXkiLCJpc0JlZm9yZSIsImRhdGUyIiwiYXJndW1lbnRzIiwiaXNTYW1lIiwiY291bnQiLCJwdXNoIiwicGFkIiwibWlzc2luZ0RheXMiLCJpbnRlZ2VyVG9BcnJheSIsImRheSIsInN1YnRyYWN0aW9uIiwicGFyc2VJbnQiLCJwcmV2aW91cyIsInN1YnRyYWN0IiwidG9JU09TdHJpbmciLCJ1bnNoaWZ0IiwiY29sbGVjdGlvbiIsImRpcmVjdGlvbiIsImNvbmNhdCIsImdyb3VwIiwiZ3JvdXBzaXplIiwic2V0cyIsImNodW5rcyIsInNwbGljZSIsInN0YXJ0IiwiZW5kIiwibmV3U3RhcnQiLCJuZXdFbmQiLCJhZGQiLCJkaWZmIiwiZmlyc3REYXkiLCJsYXN0RGF5IiwiU0FUVVJEQVkiLCJTVU5EQVkiLCJwYWRCbGFua1RpbGVzIiwiY2h1bmsiLCJhbGxEYXlzIiwiY2FsZW5kYXIiLCJtb250aCIsImRheU9mTW9udGgiLCJkYXlzSW5Nb250aCIsInNsaWNlIiwicGFkRGF5c0xlZnQiLCJsaW1pdCIsImNvdW50ZXIiLCJsaW5rRnVuY3Rpb24iLCIkc2NvcGUiLCIkZWxlbWVudCIsIiRhdHRycyIsIiRjdHJsIiwiZ2V0VGVtcGxhdGVVcmwiLCJ0ZW1wbGF0ZXMiLCJfbW9udGgyIiwid2VlayIsIl93ZWVrMiIsIl9kYXkyIiwicmVzdHJpY3QiLCJzY29wZSIsImJpbmRUb0NvbnRyb2xsZXIiLCJiY1N0YXJ0RGF0ZSIsImJjRW5kRGF0ZSIsImJjTmVzdGluZ0RlcHRoIiwiYmNEYXlzIiwiYmNEYXlUaXRsZUZvcm1hdCIsImJjTW9udGhUaXRsZUZvcm1hdCIsImJjRGF0ZVNlbGVjdGVkIiwiYmNTaG93V2Vla2RheXMiLCJiY1Nob3dNb250aFRpdGxlcyIsImJjRGF5VGVtcGxhdGUiLCJiY0RhdGVGb3JtYXQiLCJsaW5rIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiQ2FsZW5kYXJDb250cm9sbGVyIiwiY29udHJvbGxlckFzIiwiJHRlbXBsYXRlQ2FjaGUiLCJfYWN0aXZhdGUiLCIkaW5qZWN0IiwiZHVyYXRpb25JbkRheXMiLCJ3ZWVrZGF5cyIsInNlbGVjdGVkRGF0ZSIsInRlbXBsYXRlTG9jYXRpb24iLCJzdG9yZURheVRlbXBsYXRlIiwiYnVpbGREYXlzIiwiX2J1aWxkQ2FsZW5kYXIiLCJkYXRlSXNCZWZvcmVUb2RheSIsImlzRGF5VG9kYXkiLCJkZXB0aCIsImJjQ29sbGVjdGlvbiIsIm9yZ2FuaXplTW9udGhzIiwib3JnYW5pemVXZWVrcyIsImJjV2Vla2RheXNIZWFkZXIiLCJnZXREYXlUZW1wbGF0ZSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxnQkFBQUMsVUFBQSxnQkFBQUMsUUFDQUEsT0FBQUQsUUFBQUQsSUFDQSxrQkFBQUcsZ0JBQUFDLElBQ0FELE9BQUEsMkJBQUFILEdBQ0EsZ0JBQUFDLFNBQ0FBLFFBQUEseUJBQUFELElBRUFELEVBQUEseUJBQUFDLEtBQ0NLLEtBQUEsV0FDRCxNQ0FnQixVQUFVQyxHQ04xQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQVAsT0FHQSxJQUFBQyxHQUFBTyxFQUFBRCxJQUNBUCxXQUNBUyxHQUFBRixFQUNBRyxRQUFBLEVBVUEsT0FOQUwsR0FBQUUsR0FBQUksS0FBQVYsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQU0sR0FHQUwsRUFBQVMsUUFBQSxFQUdBVCxFQUFBRCxRQXZCQSxHQUFBUSxLQXFDQSxPQVRBRixHQUFBTSxFQUFBUCxFQUdBQyxFQUFBTyxFQUFBTCxFQUdBRixFQUFBUSxFQUFBLEdBR0FSLEVBQUEsS0RnQk0sU0FBU0wsRUFBUUQsRUFBU00sR0V0RGhDLFlBRUFTLFFBQU9DLGVBQWVoQixFQUFTLGNBQzNCaUIsT0FBTyxHQUhYLElBQUFDLEdBQUFaLEVBQUEsR0FDQWEsRUFBQWIsRUFBQSxHQUNBYyxFQUFBZCxFQUFBLEdBQ0FlLEVBQUFmLEVBQUEsSUFDQWdCLEVBQUFoQixFQUFBLElBQ0FpQixFQUFBakIsRUFBQSxHQWFBTixjQVhld0IsUUFBUXZCLE9BQU8sc0JBQ3pCd0Is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U0FBU3JCLEVBQVFELEVBQVNNLEdjNzNCaEMsWUFXQSxTQUFTNEIsR0FBdUJDLEdBQU8sTUFBT0EsSUFBT0EsRUFBSUMsV0FBYUQsR0FBUUUsVUFBU0YsR0FUaEYsUUFBU0YsR0FDWlAsR0FFQSxVQUVBLElBQU1HLElBQ0ZtSCxTQUFVLElBQ1ZDLE9BQU8sRUFDUEMsa0JBQ0k4QixhQUFjLEtBRWxCakIsWUFBQWhCLGFBQ0FpQixZQUFBLG9CQUFZLFNBQVNwSSxHQUlqQnhCLEtBQUtxRSxZQUFjN0MsRUFBa0J3SixtQkFFekNsQixhQUFjLEtBR2xCLE9BQU9ySSxHZDAyQlZJLEVBQWVvSSxTQUFXLG9CYy8zQjNCdEosT0FBT0MsZUFBZWhCLEVBQVMsY0FDM0JpQixPQUFPLElBRVhqQixFQUhnQmlDLGdCQUZoQixJQUFBVixHQUFBakIsRUFBQSxHQVNJeUksRUFBUTdHLEVBQXVCWCIsImZpbGUiOiJhbmd1bGFyLWpzb24tY2FsZW5kYXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJhbmd1bGFyLWpzb24tY2FsZW5kYXJcIiwgW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiYW5ndWxhci1qc29uLWNhbGVuZGFyXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcImFuZ3VsYXItanNvbi1jYWxlbmRhclwiXSA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIFxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvblxuICoqLyIsIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwiYW5ndWxhci1qc29uLWNhbGVuZGFyXCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcImFuZ3VsYXItanNvbi1jYWxlbmRhclwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJhbmd1bGFyLWpzb24tY2FsZW5kYXJcIl0gPSBmYWN0b3J5KCk7XG59KSh0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NhbGVuZGFyID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfY2FsZW5kYXIyID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblx0XG5cdHZhciBfY2FsZW5kYXIzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcblx0XG5cdHZhciBfbW9udGggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTtcblx0XG5cdHZhciBfd2VlayA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXHRcblx0dmFyIF9kYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IGFuZ3VsYXIubW9kdWxlKCdiYy5Kc29uQ2FsZW5kYXInLCBbXSkucHJvdmlkZXIoJ2JjQ2FsZW5kYXJDb25maWcnLCBfY2FsZW5kYXIuYmNDYWxlbmRhckNvbmZpZykuc2VydmljZSgnYmNDYWxlbmRhclNlcnZpY2UnLCBfY2FsZW5kYXIyLmJjQ2FsZW5kYXJTZXJ2aWNlKS5kaXJlY3RpdmUoJ2JjQ2FsZW5kYXInLCBfY2FsZW5kYXIzLmJjQ2FsZW5kYXJEaXJlY3RpdmUpLmRpcmVjdGl2ZSgnYmNNb250aCcsIF9tb250aC5iY01vbnRoRGlyZWN0aXZlKS5kaXJlY3RpdmUoJ2JjV2VlaycsIF93ZWVrLmJjV2Vla0RpcmVjdGl2ZSkuZGlyZWN0aXZlKCdiY0RheScsIF9kYXkuYmNEYXlEaXJlY3RpdmUpO1xuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0ZXhwb3J0cy5iY0NhbGVuZGFyQ29uZmlnID0gdW5kZWZpbmVkO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfZGF5SW5uZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0dmFyIF9kYXlJbm5lcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kYXlJbm5lcik7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBiY0NhbGVuZGFyQ29uZmlnID0gZXhwb3J0cy5iY0NhbGVuZGFyQ29uZmlnID0gZnVuY3Rpb24gKCkge1xuXHRcblx0ICAgIC8vIERlZmluZSBkZWZhdWx0c1xuXHQgICAgZnVuY3Rpb24gYmNDYWxlbmRhckNvbmZpZygpIHtcblx0ICAgICAgICAnbmdJbmplY3QnO1xuXHRcblx0ICAgICAgICAvLyBUaGUgY2FsZW5kYXIgd2lsbCBiZWdpbiB3aXRoIHRvZGF5XG5cdFxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBiY0NhbGVuZGFyQ29uZmlnKTtcblx0XG5cdCAgICAgICAgdGhpcy5zdGFydERhdGUgPSBtb21lbnQobmV3IERhdGUoKSkuc3RhcnRPZignZGF5JykuZm9ybWF0KCk7XG5cdFxuXHQgICAgICAgIC8vIFRoZSBkZWZhdWx0IGludGVydmFsIHR5cGUgW2RheXx3ZWVrfG1vbnRoXVxuXHQgICAgICAgIHRoaXMubmVzdGluZ0RlcHRoID0gJ21vbnRoJztcblx0XG5cdCAgICAgICAgLy8gSG93IG1hbnkgZGF5cyBzaG91bGQgYmUgZ2VuZXJhdGVkXG5cdCAgICAgICAgdGhpcy5kYXlzID0gMzA7XG5cdFxuXHQgICAgICAgIC8vIERlZmluZSB0aGUgZGlmZmVyZW50IHBvc3NpYmxlIHJlcHJlc2VudGF0aW9ucyBvZiB0aGUgd2Vla2RheVxuXHQgICAgICAgIHRoaXMud2Vla2RheVN0eWxlID0ge1xuXHQgICAgICAgICAgICBsZXR0ZXI6IFsnUycsICdNJywgJ1QnLCAnVycsICdUJywgJ0YnLCAnUyddLFxuXHQgICAgICAgICAgICBhYmJyZXZpYXRpb246IFsnU3VuJywgJ01vbicsICdUdWUnLCAnV2VkJywgJ1RodXInLCAnRnJpJywgJ1NhdCddLFxuXHQgICAgICAgICAgICB3b3JkOiBbJ1N1bmRheScsICdNb25kYXknLCAnVHVlc2RheScsICdXZWRuZXNkYXknLCAnVGh1cnNkYXknLCAnRnJpZGF5JywgJ1NhdHVyZGF5J11cblx0ICAgICAgICB9O1xuXHRcblx0ICAgICAgICAvLyBTZXQgdGhlIGRlZmF1bHQgd29yZCB0eXBlIChNIHZzIE1vbiB2cyBNb25kYXkpXG5cdCAgICAgICAgdGhpcy5kYXlUaXRsZUZvcm1hdCA9ICdhYmJyZXZpYXRpb24nO1xuXHRcblx0ICAgICAgICAvLyBTaG91bGQgdGhlIGNhbGVuZGFyIHNob3cgdGhlIHdlZWtkYXkgbmFtZXMgYWJvdmUgZWFjaCBjb2x1bW4/XG5cdCAgICAgICAgdGhpcy5zaG93V2Vla2RheXMgPSB0cnVlO1xuXHRcblx0ICAgICAgICAvLyBEZWZpbmUgdGhlIGRlZmF1bHQgdGVtcGxhdGUgZm9yIGEgZGF5XG5cdCAgICAgICAgdGhpcy5kYXlUZW1wbGF0ZSA9IF9kYXlJbm5lcjIuZGVmYXVsdDtcblx0XG5cdCAgICAgICAgLy8gQWxsb3cgdGhlIHVzZXIgdG8gc2V0IGEgY3VzdG9tIHRlbXBsYXRlXG5cdCAgICAgICAgdGhpcy5zZXREYXlUZW1wbGF0ZSA9IGZ1bmN0aW9uICh0ZW1wbGF0ZSkge1xuXHQgICAgICAgICAgICBfdGhpcy51c2VyRGF5VGVtcGxhdGUgPSB0ZW1wbGF0ZTtcblx0ICAgICAgICB9O1xuXHRcblx0ICAgICAgICAvLyBEZWZpbmUgdGhlIGRlZmF1bHQgZm9ybWF0IGZvciBhIGRheVxuXHQgICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9ICdEJztcblx0XG5cdCAgICAgICAgLy8gRGVmaW5lIHRoZSBkZWZhdWx0IGZvcm1hdCBmb3IgYSBtb250aCB0aXRsZVxuXHQgICAgICAgIHRoaXMubW9udGhUaXRsZUZvcm1hdCA9ICdNTU1NJztcblx0XG5cdCAgICAgICAgLy8gU2hvdWxkIG1vbnRoIHRpdGxlcyBiZSBzaG93biBieSBkZWZhdWx0P1xuXHQgICAgICAgIHRoaXMuc2hvd01vbnRoVGl0bGVzID0gdHJ1ZTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoYmNDYWxlbmRhckNvbmZpZywgW3tcblx0ICAgICAgICBrZXk6ICckZ2V0Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gJGdldCgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBiY0NhbGVuZGFyQ29uZmlnO1xuXHR9KCk7XG5cbi8qKiovIH0sXG4vKiAyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHR2YXIgcGF0aCA9ICcvVXNlcnMvYmMvQ29kZS9vcGVuLXNvdXJjZS9hbmd1bGFyLWpzb24tY2FsZW5kYXIvc3JjL3RlbXBsYXRlcy9kYXkuaW5uZXIuaHRtbCc7XG5cdHZhciBodG1sID0gXCI8dGltZSBkYXRldGltZT1cXFwie3sgZGF5LmRhdGUgfCBkYXRlOid5eXl5LU1NLWRkJyB9fVxcXCIgY2xhc3M9YmMtY2FsZW5kYXJfX2RheS10aW1lIHRpdGxlPVxcXCJ7eyBkYXkuZGF0ZSB9fVxcXCIgZGF0YS1uZy1pZj1kYXkuZGF0ZT4gPHNwYW4gZGF0YS1uZy1iaW5kPVxcXCIkY3RybC5mb3JtYXREYXRlKGRheS5kYXRlLCAkY3RybC5kYXRlRm9ybWF0KVxcXCI+PC9zcGFuPiA8L3RpbWU+XCI7XG5cdHdpbmRvdy5hbmd1bGFyLm1vZHVsZSgnbmcnKS5ydW4oWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uKGMpIHsgYy5wdXQocGF0aCwgaHRtbCkgfV0pO1xuXHRtb2R1bGUuZXhwb3J0cyA9IHBhdGg7XG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHR2YXIgYmNDYWxlbmRhclNlcnZpY2UgPSBleHBvcnRzLmJjQ2FsZW5kYXJTZXJ2aWNlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gYmNDYWxlbmRhclNlcnZpY2UoKSB7XG5cdCAgICAgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIGJjQ2FsZW5kYXJTZXJ2aWNlKTtcblx0XG5cdCAgICAgICAgdGhpcy5XRUVLX0xFTkdUSCA9IDc7XG5cdCAgICAgICAgdGhpcy5kYXlUZW1wbGF0ZTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIENoZWNrIHRvIHNlZSBpZiB0aGUgZGF5IGlzIHByaW9yIHRvIHRoZSBjdXJyZW50IGRhdGVcblx0ICAgICAqIFRoaXMgaXMgdXNlZCB0byBkaXNhYmxlIHRoZSB1bnNlbGVjdGFibGUgZGF5c1xuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRlXG5cdCAgICAgKiBAcmV0dXJuIHtCb29sfSBpc0JlZm9yZVxuXHQgICAgICovXG5cdFxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhiY0NhbGVuZGFyU2VydmljZSwgW3tcblx0ICAgICAgICBrZXk6ICdkYXRlSXNCZWZvcmVUb2RheScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRhdGVJc0JlZm9yZVRvZGF5KGRhdGUpIHtcblx0ICAgICAgICAgICAgdmFyIHRvZGF5ID0gbW9tZW50KG5ldyBEYXRlKCkpLnN0YXJ0T2YoJ2RheScpLmZvcm1hdCgpO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIG1vbWVudChkYXRlKS5pc0JlZm9yZSh0b2RheSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBDaGVjayB0byBzZWUgaWYgdGhlIGRheSBtYXRjaGVzIHRoZSBjdXJyZW50IGRhdGVcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRlXG5cdCAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGRhdGUyXG5cdCAgICAgICAgICogQHJldHVybiB7Qm9vbH0gaXNUb2RheVxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdpc0RheVRvZGF5Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNEYXlUb2RheShkYXRlKSB7XG5cdCAgICAgICAgICAgIHZhciBkYXRlMiA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IG1vbWVudChuZXcgRGF0ZSgpKS5mb3JtYXQoKSA6IGFyZ3VtZW50c1sxXTtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiBtb21lbnQoZGF0ZSkuaXNTYW1lKGRhdGUyKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIFR1cm4gYSBpbnRlZ2VyIChlLmcuICc2JykgaW50byBhbiBhcnJheTogJ1sxLDIsMyw0LDUsNl0nXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge0ludGVnZXJ9IGNvdW50XG5cdCAgICAgICAgICogQHJldHVybiB7QXJyYXl9IGRheXNcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnaW50ZWdlclRvQXJyYXknLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnRlZ2VyVG9BcnJheShjb3VudCkge1xuXHQgICAgICAgICAgICB2YXIgaSA9IHZvaWQgMDtcblx0ICAgICAgICAgICAgdmFyIGRheXMgPSBbXTtcblx0XG5cdCAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSArPSAxKSB7XG5cdCAgICAgICAgICAgICAgICBkYXlzLnB1c2goaSk7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiBkYXlzO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogUGFkIHRoZSBiZWdpbm5pbmcgb2YgYSB3ZWVrXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RhcnREYXRlIC0gZGF0ZSB0byB0byB3b3JrIGJhY2sgZnJvbVxuXHQgICAgICAgICAqIEBwYXJhbSB7QXJyYXl9IGNvdW50IC0gaG93IG1hbnkgZGF5cyB0byBwYWRcblx0ICAgICAgICAgKiBAcmV0dXJuIHtBcnJheX0gcGFkXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3BhZERheXNMZWZ0Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFkRGF5c0xlZnQoc3RhcnREYXRlLCBjb3VudCkge1xuXHQgICAgICAgICAgICB2YXIgcGFkID0gW107XG5cdCAgICAgICAgICAgIHZhciBtaXNzaW5nRGF5cyA9IHRoaXMuaW50ZWdlclRvQXJyYXkoY291bnQpO1xuXHRcblx0ICAgICAgICAgICAgLy8gTG9vcCB0aHJvdWdoIG1pc3NpbmcgZGF5c1xuXHQgICAgICAgICAgICBmb3IgKHZhciBkYXkgaW4gbWlzc2luZ0RheXMpIHtcblx0ICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGRheXMgdG8gZ28gYmFja1xuXHQgICAgICAgICAgICAgICAgdmFyIHN1YnRyYWN0aW9uID0gcGFyc2VJbnQoZGF5LCAxMCkgKyAxO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhhdCBkYXlcblx0ICAgICAgICAgICAgICAgIHZhciBwcmV2aW91cyA9IG1vbWVudChzdGFydERhdGUpLnN1YnRyYWN0KHN1YnRyYWN0aW9uLCAnZGF5cycpLnRvSVNPU3RyaW5nKCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gQWRkIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGFycmF5XG5cdCAgICAgICAgICAgICAgICBwYWQudW5zaGlmdCh7XG5cdCAgICAgICAgICAgICAgICAgICAgZGF0ZTogcHJldmlvdXNcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gcGFkO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogUGFkIGEgY29sbGVjdGlvbiB3aXRoIGJsYW5rIHRpbGVzXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge0FycmF5fSBjb2xsZWN0aW9uXG5cdCAgICAgICAgICogQHBhcmFtIHtJbnRlZ2VyfSBjb3VudFxuXHQgICAgICAgICAqIEByZXR1cm4ge0FycmF5fSBwYWRkZWRDb2xsZWN0aW9uXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3BhZEJsYW5rVGlsZXMnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYWRCbGFua1RpbGVzKGNvbGxlY3Rpb24sIGNvdW50KSB7XG5cdCAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyAnbGVmdCcgOiBhcmd1bWVudHNbMl07XG5cdFxuXHQgICAgICAgICAgICB2YXIgaSA9IHZvaWQgMDtcblx0ICAgICAgICAgICAgdmFyIGRheXMgPSBbXTtcblx0XG5cdCAgICAgICAgICAgIC8vIENyZWF0ZSBhcnJheVxuXHQgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkgKz0gMSkge1xuXHQgICAgICAgICAgICAgICAgZGF5cy5wdXNoKHtcblx0ICAgICAgICAgICAgICAgICAgICBkYXRlOiBudWxsXG5cdCAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgLy8gSWYgZGlyZWN0aW9uIGlzICdyaWdodCdcblx0ICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuXHQgICAgICAgICAgICAgICAgLy8gcGFkIHRoZSBlbmRcblx0ICAgICAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uLmNvbmNhdChkYXlzKTtcblx0ICAgICAgICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0Jykge1xuXHQgICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIHBhZCB0aGUgYmVnaW5uaW5nXG5cdCAgICAgICAgICAgICAgICByZXR1cm4gZGF5cy5jb25jYXQoY29sbGVjdGlvbik7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIFNwbGl0IGFuIGFycmF5IGludG8gY2h1bmtzIGFuZCByZXR1cm4gYW4gYXJyYXkgb2YgdGhlc2UgY2h1bmtzXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcGFyYW0ge0FycmF5fSBncm91cFxuXHQgICAgICAgICAqIEBwYXJhbSB7SW50ZWdlcn0gZ3JvdXBzaXplIC0gQ2h1bmsgc2l6ZS4gRGVmYXVsdHMgdG8gNyAob25lIHdlZWspLlxuXHQgICAgICAgICAqIEByZXR1cm4ge0FycmF5fSBjaHVua3Ncblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY2h1bmsnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjaHVuayhncm91cCkge1xuXHQgICAgICAgICAgICB2YXIgZ3JvdXBzaXplID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gdGhpcy5XRUVLX0xFTkdUSCA6IGFyZ3VtZW50c1sxXTtcblx0XG5cdCAgICAgICAgICAgIHZhciBzZXRzID0gW107XG5cdCAgICAgICAgICAgIHZhciBpID0gMDtcblx0ICAgICAgICAgICAgdmFyIGNodW5rcyA9IGdyb3VwLmxlbmd0aCAvIHBhcnNlSW50KGdyb3Vwc2l6ZSwgMTApO1xuXHRcblx0ICAgICAgICAgICAgd2hpbGUgKGkgPCBjaHVua3MpIHtcblx0ICAgICAgICAgICAgICAgIHNldHNbaV0gPSBncm91cC5zcGxpY2UoMCwgZ3JvdXBzaXplKTtcblx0ICAgICAgICAgICAgICAgIGkgPSBpICsgMTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHNldHM7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBHZXQgdGhlIGR1cmF0aW9uIGluIGRheXMgYmV0d2VlbiB0d28gZGF0ZXMgSU5DTFVESU5HIGJvdGggZGF0ZXNcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdGFydFxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBlbmRcblx0ICAgICAgICAgKiBAcmV0dXJuIHtJbnRlZ2VyfSBkYXlzXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2R1cmF0aW9uSW5EYXlzJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZHVyYXRpb25JbkRheXMoc3RhcnQsIGVuZCkge1xuXHQgICAgICAgICAgICB2YXIgbmV3U3RhcnQgPSBtb21lbnQoc3RhcnQpLnN0YXJ0T2YoJ2RheScpO1xuXHQgICAgICAgICAgICAvLyBBZGQgYSBkYXkgc28gdGhlIGVuZCBkYXRlIGlzIGluY2x1ZGVkIGluIHRoZSBjYWxjdWxhdGlvblxuXHQgICAgICAgICAgICB2YXIgbmV3RW5kID0gbW9tZW50KGVuZCkuc3RhcnRPZignZGF5JykuYWRkKDEsICdkYXlzJyk7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gbmV3RW5kLmRpZmYobmV3U3RhcnQsICdkYXlzJyk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBPcmdhbml6ZSBhIGNvbGxlY3Rpb24gb2YgZGF5cyBpbnRvIHN1YiBjb2xsZWN0aW9ucyBvZiB3ZWVrc1xuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtBcnJheX0gZGF5cyAtIGFycmF5IG9mIGRheXNcblx0ICAgICAgICAgKiBAcmV0dXJuIHtBcnJheX0gY29sbGVjdGlvblxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdvcmdhbml6ZVdlZWtzJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3JnYW5pemVXZWVrcyhkYXlzKSB7XG5cdCAgICAgICAgICAgIC8vIERldGVybWluZSB0aGUgZGF5IG9mIHRoZSB3ZWVrIHRoYXQgdGhlIGNhbGVuZGFyIHN0YXJ0cyBhbmQgZW5kcyBvblxuXHQgICAgICAgICAgICB2YXIgZmlyc3REYXkgPSBtb21lbnQoZGF5c1swXS5kYXRlKS5kYXkoKTtcblx0ICAgICAgICAgICAgdmFyIGxhc3REYXkgPSBtb21lbnQoZGF5c1tkYXlzLmxlbmd0aCAtIDFdLmRhdGUpLmRheSgpO1xuXHQgICAgICAgICAgICB2YXIgU0FUVVJEQVkgPSA2O1xuXHQgICAgICAgICAgICB2YXIgU1VOREFZID0gMDtcblx0XG5cdCAgICAgICAgICAgIC8vIElmIHRoZSBmaXJzdCBkYXkgaXMgYWZ0ZXIgU3VuZGF5XG5cdCAgICAgICAgICAgIGlmIChmaXJzdERheSA+IFNVTkRBWSkge1xuXHQgICAgICAgICAgICAgICAgLy8gUGFkIHdpdGggYmxhbmsgdGlsZXMgc28gdGhlIGZpcnN0IGRheSBpcyBsaW5lZCB1cCBpbiB0aGUgY29ycmVjdCB3ZWVrZGF5IGNvbHVtblxuXHQgICAgICAgICAgICAgICAgZGF5cyA9IHRoaXMucGFkQmxhbmtUaWxlcyhkYXlzLCBmaXJzdERheSwgJ2xlZnQnKTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgLy8gSWYgdGhlIGxhc3QgZGF5IGlzIGJlZm9yZSBTYXR1cmRheVxuXHQgICAgICAgICAgICBpZiAobGFzdERheSA8IFNBVFVSREFZKSB7XG5cdCAgICAgICAgICAgICAgICAvLyBQYWQgd2l0aCBibGFuayB0aWxlcyBzbyB0aGF0IHRoZSBsYXN0IHdlZWsncyBkYXlzIGFyZSBpbiB0aGUgY29ycmVjdCB3ZWVrZGF5IGNvbHVtblxuXHQgICAgICAgICAgICAgICAgZGF5cyA9IHRoaXMucGFkQmxhbmtUaWxlcyhkYXlzLCB0aGlzLldFRUtfTEVOR1RIIC0gKGxhc3REYXkgKyAxKSwgJ3JpZ2h0Jyk7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLmNodW5rKGRheXMpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogT3JnYW5pemUgYnkgbW9udGhcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7QXJyYXl9IGFsbERheXMgLSBBbiBhcnJheSBvZiBhbGwgZGF5c1xuXHQgICAgICAgICAqIEByZXR1cm4ge0FycmF5fSBjb2xsZWN0aW9uIC0gZGF5cyBvcmdhbml6ZWQgaW50byB3ZWVrcyBhbmQgbW9udGhzXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ29yZ2FuaXplTW9udGhzJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3JnYW5pemVNb250aHMoYWxsRGF5cykge1xuXHQgICAgICAgICAgICB2YXIgY2FsZW5kYXIgPSBbXTtcblx0ICAgICAgICAgICAgdmFyIFNBVFVSREFZID0gNjtcblx0ICAgICAgICAgICAgdmFyIFNVTkRBWSA9IDA7XG5cdCAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gYWxsRGF5cztcblx0ICAgICAgICAgICAgdmFyIG1vbnRoID0gdm9pZCAwO1xuXHQgICAgICAgICAgICB2YXIgZGF5T2ZNb250aCA9IG1vbWVudChjb2xsZWN0aW9uWzBdLmRhdGUpLmRhdGUoKTtcblx0ICAgICAgICAgICAgdmFyIGRheXNJbk1vbnRoID0gbW9tZW50KGNvbGxlY3Rpb25bMF0uZGF0ZSkuZGF5c0luTW9udGgoKTtcblx0XG5cdCAgICAgICAgICAgIC8vIFBhZCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBtb250aCB3aXRoIGFueSBtaXNzaW5nIGRheXNcblx0ICAgICAgICAgICAgLy8gSWYgdGhlIGZpcnN0IGRheSBpcyBub3QgdGhlIGZpcnN0IGRheSBvZiB0aGUgbW9udGhcblx0ICAgICAgICAgICAgaWYgKG1vbWVudChjb2xsZWN0aW9uWzBdLmRhdGUpLmRhdGUoKSA+IDApIHtcblx0ICAgICAgICAgICAgICAgIC8vIFB1bGwgdGhpcyBtb250aCdzIGRheXMgZnJvbSB0aGUgY29sbGVjdGlvblxuXHQgICAgICAgICAgICAgICAgbW9udGggPSBjb2xsZWN0aW9uLnNsaWNlKDAsIGRheXNJbk1vbnRoIC0gKGRheU9mTW9udGggLSAxKSk7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gRmlsbCB0aGUgbWlzc2luZyBkYXlzIGZyb20gdGhlIG1vbnRoXG5cdCAgICAgICAgICAgICAgICB2YXIgcGFkID0gdGhpcy5wYWREYXlzTGVmdChtb250aFswXS5kYXRlLCBkYXlPZk1vbnRoIC0gMSk7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gQ29tYmluZSB3aXRoIHRoZSBleGlzdGluZyBhcnJheVxuXHQgICAgICAgICAgICAgICAgY29sbGVjdGlvbiA9IHBhZC5jb25jYXQoY29sbGVjdGlvbik7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIC8vIFNwbGl0IGludG8gbW9udGhzXG5cdCAgICAgICAgICAgIC8vIEFzIGxvbmcgYXMgdGhlcmUgYXJlIGRheXMgbGVmdCBpbiB0aGUgY29sbGVjdGlvblxuXHQgICAgICAgICAgICB3aGlsZSAoY29sbGVjdGlvbi5sZW5ndGggPiAwKSB7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBkYXkgb2YgdGhlIG1vbnRoIGZvciB0aGUgZmlyc3QgZGF0ZSBvZiB0aGUgY29sbGVjdGlvbiBlZy4gJzI0J1xuXHQgICAgICAgICAgICAgICAgZGF5T2ZNb250aCA9IG1vbWVudChjb2xsZWN0aW9uWzBdLmRhdGUpLmRhdGUoKTtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBEZXRlcm1pbmUgaG93IG1hbnkgZGF5cyB0aGVyZSBhcmUgdGhpcyBtb250aCAodG90YWwpXG5cdCAgICAgICAgICAgICAgICBkYXlzSW5Nb250aCA9IG1vbWVudChjb2xsZWN0aW9uWzBdLmRhdGUpLmRheXNJbk1vbnRoKCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gUHVsbCB0aGlzIG1vbnRoJ3MgZGF5cyBmcm9tIHRoZSBjb2xsZWN0aW9uXG5cdCAgICAgICAgICAgICAgICBtb250aCA9IGNvbGxlY3Rpb24uc3BsaWNlKDAsIGRheXNJbk1vbnRoIC0gKGRheU9mTW9udGggLSAxKSk7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gSG93IG1hbnkgd2Vla2RheXMgYXJlIHByaW9yIHRvIHRoZSBmaXJzdCBkYXkgb2YgdGhpcyBtb250aD9cblx0ICAgICAgICAgICAgICAgIHZhciBmaXJzdERheSA9IG1vbWVudChtb250aFswXS5kYXRlKS5kYXkoKTtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBJZiB0aGUgZmlyc3QgZGF5IGlzIGFmdGVyIFN1bmRheVxuXHQgICAgICAgICAgICAgICAgaWYgKGZpcnN0RGF5ID4gU1VOREFZKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgLy8gUGFkIHdpdGggYmxhbmsgdGlsZXMgc28gdGhhdCB0aGUgZmlyc3QgZGF5IGlzIGxpbmVkIHVwIGluIHRoZSBjb3JyZWN0IGNvbHVtblxuXHQgICAgICAgICAgICAgICAgICAgIG1vbnRoID0gdGhpcy5wYWRCbGFua1RpbGVzKG1vbnRoLCBmaXJzdERheSwgJ2xlZnQnKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgICAgICAvLyBIb3cgbWFueSB3ZWVrZGF5cyBhcmUgYWZ0ZXIgdGhlIGxhc3QgZGF5IG9mIHRoZSBtb250aD9cblx0ICAgICAgICAgICAgICAgIC8vIChyZW1lbWJlcjogd2Vla3MgYXJlIHplcm8tYmFzZWQpXG5cdCAgICAgICAgICAgICAgICB2YXIgbGFzdERheSA9IG1vbWVudChtb250aFttb250aC5sZW5ndGggLSAxXS5kYXRlKS5kYXkoKTtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBJZiBibGFuayB0aWxlcyBhcmUgbmVlZGVkIGZvciB0aGUgbGFzdCB3ZWVrXG5cdCAgICAgICAgICAgICAgICBpZiAobGFzdERheSA8IFNBVFVSREFZKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgLy8gUGFkIHdpdGggYmxhbmsgdGlsZXMgc28gdGhhdCB0aGUgZmlyc3QgZGF5IGlzIGxpbmVkIHVwIGluIHRoZSBjb3JyZWN0IGNvbHVtblxuXHQgICAgICAgICAgICAgICAgICAgIG1vbnRoID0gdGhpcy5wYWRCbGFua1RpbGVzKG1vbnRoLCB0aGlzLldFRUtfTEVOR1RIIC0gKGxhc3REYXkgKyAxKSwgJ3JpZ2h0Jyk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gT3JnYW5pemUgaW50byB3ZWVrcyBhbmQgYWRkIHRvIHRoZSBjYWxlbmRhciBhcnJheVxuXHQgICAgICAgICAgICAgICAgY2FsZW5kYXIucHVzaCh0aGlzLmNodW5rKG1vbnRoKSk7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiBjYWxlbmRhcjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEJ1aWxkIGFuIGFycmF5IG9mIGRheXNcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7SW50ZWdlcn0gbGltaXQgLSBob3cgbWFueSBkYXlzIHRvIGNyZWF0ZVxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdGFydCAtIHRoZSBzdGFydGluZyBkYXRlXG5cdCAgICAgICAgICogQHJldHVybiB7QXJyYXl9IGRheXNcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnYnVpbGREYXlzJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGREYXlzKGxpbWl0KSB7XG5cdCAgICAgICAgICAgIHZhciBzdGFydCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IG5ldyBEYXRlKCkgOiBhcmd1bWVudHNbMV07XG5cdFxuXHQgICAgICAgICAgICB2YXIgY291bnRlciA9IDA7XG5cdCAgICAgICAgICAgIHZhciBkYXlzID0gW107XG5cdCAgICAgICAgICAgIHZhciBkYXkgPSB2b2lkIDA7XG5cdFxuXHQgICAgICAgICAgICB3aGlsZSAoY291bnRlciA8IGxpbWl0KSB7XG5cdCAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGRheVxuXHQgICAgICAgICAgICAgICAgZGF5ID0gbW9tZW50KHN0YXJ0KS5hZGQoY291bnRlciwgJ2RheXMnKS50b0lTT1N0cmluZygpO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIEFkZCB0byB0aGUgYXJyYXlcblx0ICAgICAgICAgICAgICAgIGRheXMucHVzaCh7XG5cdCAgICAgICAgICAgICAgICAgICAgZGF0ZTogZGF5XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBJbmNyZW1lbnQgdGhlIGNvdW50ZXJcblx0ICAgICAgICAgICAgICAgIGNvdW50ZXIgPSBjb3VudGVyICsgMTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIGRheXM7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBTZXQgdGhlIGlubmVyIGRheSB0ZW1wbGF0ZVxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IHRlbXBsYXRlXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3N0b3JlRGF5VGVtcGxhdGUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9yZURheVRlbXBsYXRlKHRlbXBsYXRlKSB7XG5cdCAgICAgICAgICAgIHRoaXMuZGF5VGVtcGxhdGUgPSB0ZW1wbGF0ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEdldCB0aGUgaW5uZXIgZGF5IHRlbXBsYXRlXG5cdCAgICAgICAgICpcblx0ICAgICAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IHRlbXBsYXRlXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2dldERheVRlbXBsYXRlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF5VGVtcGxhdGUoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLmRheVRlbXBsYXRlO1xuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gYmNDYWxlbmRhclNlcnZpY2U7XG5cdH0oKTtcblxuLyoqKi8gfSxcbi8qIDQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuYmNDYWxlbmRhckRpcmVjdGl2ZSA9IGJjQ2FsZW5kYXJEaXJlY3RpdmU7XG5cdFxuXHR2YXIgX2NhbGVuZGFyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblx0XG5cdHZhciBfY2FsZW5kYXIyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTtcblx0XG5cdHZhciBfY2FsZW5kYXIzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2FsZW5kYXIyKTtcblx0XG5cdHZhciBfbW9udGggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpO1xuXHRcblx0dmFyIF9tb250aDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tb250aCk7XG5cdFxuXHR2YXIgX3dlZWsgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xuXHRcblx0dmFyIF93ZWVrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3dlZWspO1xuXHRcblx0dmFyIF9kYXkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHRcblx0dmFyIF9kYXkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGF5KTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBiY0NhbGVuZGFyRGlyZWN0aXZlKCkge1xuXHQgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICAvLyBEZWZpbmUgcG9zc2libGUgdGVtcGxhdGVzXG5cdFxuXHQgICAgdmFyIHRlbXBsYXRlcyA9IHtcblx0ICAgICAgICBtb250aDogX21vbnRoMi5kZWZhdWx0LFxuXHQgICAgICAgIHdlZWs6IF93ZWVrMi5kZWZhdWx0LFxuXHQgICAgICAgIGRheTogX2RheTIuZGVmYXVsdFxuXHQgICAgfTtcblx0XG5cdCAgICB2YXIgZGlyZWN0aXZlID0ge1xuXHQgICAgICAgIHJlc3RyaWN0OiAnRScsXG5cdCAgICAgICAgc2NvcGU6IHt9LFxuXHQgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcblx0ICAgICAgICAgICAgYmNTdGFydERhdGU6ICdAPycsIC8vIGRhdGUgLSBkZWZhdWx0IHRvIHRvZGF5XG5cdCAgICAgICAgICAgIGJjRW5kRGF0ZTogJ0A/JywgLy8gZGF0ZSAtIGlmIG5vdCBwcmVzZW50LCB1c2UgY3JlYXRlIHVzaW5nIGJjRGF5c1xuXHQgICAgICAgICAgICBiY05lc3RpbmdEZXB0aDogJ0A/JywgLy8gc3RyaW5nIFttb250aHx3ZWVrfGRheV0gLSBkZWZhdWx0czogbW9udGhcblx0ICAgICAgICAgICAgYmNEYXlzOiAnQD8nLCAvLyBpbnRlZ2VyIC0gZGVmYXVsdCB0byAzMCAodXNlZCB0byBjcmVhdGUgYmNFbmREYXRlKVxuXHQgICAgICAgICAgICBiY0RheVRpdGxlRm9ybWF0OiAnQD8nLCAvLyBzdHJpbmcgW3dvcmR8YWJicmV2aWF0aW9ufGxldHRlcl0gLSBkZWZhdWx0OiBhYmJyZXZpYXRpb25cblx0ICAgICAgICAgICAgYmNNb250aFRpdGxlRm9ybWF0OiAnQD8nLCAvLyBzdHJpbmcgLSBhbnkgdmFsaWQgTW9tZW50IGRhdGUgZm9ybWF0IC0gZGVmYXVsdDogTU1NTVxuXHQgICAgICAgICAgICBiY0RhdGVTZWxlY3RlZDogJyYnLCAvLyBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCB3aGVuIGEgZGF0ZSBpcyBzZWxlY3RlZCAodGFwL2NsaWNrKVxuXHQgICAgICAgICAgICBiY1Nob3dXZWVrZGF5czogJz0/JywgLy8gZGV0ZXJtaW5lIGlmIHRoZSB3ZWVrZGF5cyBoZWFkZXIgc2hvdWxkIGJlIGNyZWF0ZWRcblx0ICAgICAgICAgICAgYmNTaG93TW9udGhUaXRsZXM6ICc9PycsIC8vIGRldGVybWluZSBpZiB0aGUgbW9udGggdGl0bGVzIHNob3VsZCBiZSB2aXNpYmxlXG5cdCAgICAgICAgICAgIGJjRGF5VGVtcGxhdGU6ICdAPycsIC8vIG92ZXJ3cml0ZSB0aGUgZGVmYXVsdCAnZGF5JyB0ZW1wbGF0ZVxuXHQgICAgICAgICAgICBiY0RhdGVGb3JtYXQ6ICdAPycgfSxcblx0ICAgICAgICBsaW5rOiBsaW5rRnVuY3Rpb24sXG5cdCAgICAgICAgdGVtcGxhdGVVcmw6IF9jYWxlbmRhcjMuZGVmYXVsdCxcblx0ICAgICAgICBjb250cm9sbGVyOiBfY2FsZW5kYXIuQ2FsZW5kYXJDb250cm9sbGVyLFxuXHQgICAgICAgIGNvbnRyb2xsZXJBczogJyRjdHJsJ1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gZGlyZWN0aXZlO1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogTGlua1xuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBsaW5rRnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkY3RybCkge1xuXHRcblx0ICAgICAgICAvLyBTZXQgdGhlIGNvcnJlY3QgdGVtcGxhdGUgYmFzZWQgb24gdGhlIGRlc2lyZWQgbmVzdGluZyBkZXB0aFxuXHQgICAgICAgICRjdHJsLmdldFRlbXBsYXRlVXJsID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGVtcGxhdGVzWyRjdHJsLm5lc3RpbmdEZXB0aF07XG5cdCAgICAgICAgfTtcblx0ICAgIH1cblx0fVxuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0dmFyIENhbGVuZGFyQ29udHJvbGxlciA9IGV4cG9ydHMuQ2FsZW5kYXJDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgQ2FsZW5kYXJDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkdGVtcGxhdGVDYWNoZVwiLCBcImJjQ2FsZW5kYXJDb25maWdcIiwgXCJiY0NhbGVuZGFyU2VydmljZVwiXTtcblx0ICAgIGZ1bmN0aW9uIENhbGVuZGFyQ29udHJvbGxlcigkdGVtcGxhdGVDYWNoZSwgYmNDYWxlbmRhckNvbmZpZywgYmNDYWxlbmRhclNlcnZpY2UpIHtcblx0ICAgICAgICAnbmdJbmplY3QnO1xuXHRcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2FsZW5kYXJDb250cm9sbGVyKTtcblx0XG5cdCAgICAgICAgdGhpcy4kdGVtcGxhdGVDYWNoZSA9ICR0ZW1wbGF0ZUNhY2hlO1xuXHQgICAgICAgIHRoaXMuYmNDYWxlbmRhckNvbmZpZyA9IGJjQ2FsZW5kYXJDb25maWc7XG5cdCAgICAgICAgdGhpcy5iY0NhbGVuZGFyU2VydmljZSA9IGJjQ2FsZW5kYXJTZXJ2aWNlO1xuXHRcblx0ICAgICAgICB0aGlzLl9hY3RpdmF0ZSgpO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhDYWxlbmRhckNvbnRyb2xsZXIsIFt7XG5cdCAgICAgICAga2V5OiAnX2FjdGl2YXRlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2FjdGl2YXRlKCkge1xuXHQgICAgICAgICAgICAvLyBEZWZpbmUgdG9kYXkncyBkYXRlXG5cdCAgICAgICAgICAgIHRoaXMudG9kYXkgPSBtb21lbnQobmV3IERhdGUoKSkuc3RhcnRPZignZGF5Jyk7XG5cdFxuXHQgICAgICAgICAgICAvLyBEZWZpbmUgdGhlIHN0YXJ0IGRhdGUgZm9yIHRoZSBjYWxlbmRhclxuXHQgICAgICAgICAgICB0aGlzLnN0YXJ0RGF0ZSA9IHRoaXMuYmNTdGFydERhdGUgfHwgdGhpcy5iY0NhbGVuZGFyQ29uZmlnLnN0YXJ0RGF0ZTtcblx0XG5cdCAgICAgICAgICAgIC8vIElmIHRoZSBlbmQgZGF0ZSB3YXMgZGVmaW5lZFxuXHQgICAgICAgICAgICBpZiAodGhpcy5iY0VuZERhdGUpIHtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBEZWZpbmUgaG93IG1hbnkgZGF5cyBhcmUgbmVlZGVkIHVzaW5nIHRoZSBlbmQgZGF0ZVxuXHQgICAgICAgICAgICAgICAgdGhpcy5kYXlzID0gdGhpcy5iY0NhbGVuZGFyU2VydmljZS5kdXJhdGlvbkluRGF5cyh0aGlzLnN0YXJ0RGF0ZSwgdGhpcy5iY0VuZERhdGUpO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIERlZmluZSBob3cgbWFueSBkYXlzIGFyZSBuZWVkZWQgZnJvbSB0aGUgY291bnQgcGFzc2VkIGluIG9yIHRoZSBjb25maWdcblx0ICAgICAgICAgICAgICAgIHRoaXMuZGF5cyA9IHBhcnNlSW50KHRoaXMuYmNEYXlzIHx8IHRoaXMuYmNDYWxlbmRhckNvbmZpZy5kYXlzLCAxMCk7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIC8vIERlZmluZSBob3cgZGVlcCB0byBvcmdhbml6ZSB0aGUgY2FsZW5kYXJcblx0ICAgICAgICAgICAgdGhpcy5uZXN0aW5nRGVwdGggPSB0aGlzLmJjTmVzdGluZ0RlcHRoIHx8IHRoaXMuYmNDYWxlbmRhckNvbmZpZy5uZXN0aW5nRGVwdGg7XG5cdFxuXHQgICAgICAgICAgICAvLyBEZWZpbmUgdGhlIHdlZWtkYXkgaGVhZGVycyBmb3JtYXRcblx0ICAgICAgICAgICAgdGhpcy53ZWVrZGF5cyA9IHRoaXMuYmNEYXlUaXRsZUZvcm1hdCA/IHRoaXMuYmNDYWxlbmRhckNvbmZpZy53ZWVrZGF5U3R5bGVbdGhpcy5iY0RheVRpdGxlRm9ybWF0XSA6IHRoaXMuYmNDYWxlbmRhckNvbmZpZy53ZWVrZGF5U3R5bGVbdGhpcy5iY0NhbGVuZGFyQ29uZmlnLmRheVRpdGxlRm9ybWF0XTtcblx0XG5cdCAgICAgICAgICAgIC8vIERlZmluZSB0aGUgZm9ybWF0IGZvciB0aGUgbW9udGggdGl0bGVcblx0ICAgICAgICAgICAgdGhpcy5tb250aFRpdGxlRm9ybWF0ID0gdGhpcy5iY01vbnRoVGl0bGVGb3JtYXQgfHwgdGhpcy5iY0NhbGVuZGFyQ29uZmlnLm1vbnRoVGl0bGVGb3JtYXQ7XG5cdFxuXHQgICAgICAgICAgICAvLyBEZWZpbmUgaWYgbW9udGggdGl0bGVzIHNob3VsZCBiZSB2aXNpYmxlXG5cdCAgICAgICAgICAgIHRoaXMuc2hvd01vbnRoVGl0bGVzID0gdHlwZW9mIHRoaXMuYmNTaG93TW9udGhUaXRsZXMgPT09ICdib29sZWFuJyA/IHRoaXMuYmNTaG93TW9udGhUaXRsZXMgOiB0aGlzLmJjQ2FsZW5kYXJDb25maWcuc2hvd01vbnRoVGl0bGVzO1xuXHRcblx0ICAgICAgICAgICAgLy8gSW5pdGlhbGx5IG5vIGRhdGUgaXMgc2VsZWN0ZWRcblx0ICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGUgPSBudWxsO1xuXHRcblx0ICAgICAgICAgICAgLy8gU2V0IHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBjYWxlbmRhciB3ZWVrZGF5cyBoZWFkZXJzXG5cdCAgICAgICAgICAgIHRoaXMuc2hvd1dlZWtkYXlzID0gdHlwZW9mIHRoaXMuYmNTaG93V2Vla2RheXMgPT09ICdib29sZWFuJyA/IHRoaXMuYmNTaG93V2Vla2RheXMgOiB0aGlzLmJjQ2FsZW5kYXJDb25maWcuc2hvd1dlZWtkYXlzO1xuXHRcblx0ICAgICAgICAgICAgLy8gSWYgYSBjdXN0b20gZGF5IHRlbXBsYXRlIGhhcyBiZWVuIHNldCBpbiBlaXRoZXIgbG9jYXRpb24gKGF0dHJpYnV0ZSBvciBwcm92aWRlcilcblx0ICAgICAgICAgICAgaWYgKHRoaXMuYmNEYXlUZW1wbGF0ZSB8fCB0aGlzLmJjQ2FsZW5kYXJDb25maWcudXNlckRheVRlbXBsYXRlKSB7XG5cdCAgICAgICAgICAgICAgICAvLyBOYW1lIHRoZSB0ZW1wbGF0ZSBsb2NhdGlvblxuXHQgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlTG9jYXRpb24gPSAndXNlckRheVRlbXBsYXRlLmh0bWwnO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIElmIHRoZSB1c2VyIHNldCBhIHRlbXBsYXRlIHZpYSB0aGUgZGlyZWN0aXZlIGF0dHJpYnV0ZVxuXHQgICAgICAgICAgICAgICAgaWYgKHRoaXMuYmNEYXlUZW1wbGF0ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIC8vIFB1dCB0aGUgdXNlciB0ZW1wbGF0ZSBpbnRvIHRoZSBjYWNoZVxuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuJHRlbXBsYXRlQ2FjaGUucHV0KHRlbXBsYXRlTG9jYXRpb24sIHRoaXMuYmNEYXlUZW1wbGF0ZSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gSWYgdGhlIHVzZXIgZGVmaW5lZCBhIHRlbXBsYXRlIHVzaW5nIHRoZSBwcm92aWRlclxuXHQgICAgICAgICAgICAgICAgaWYgKHRoaXMuYmNDYWxlbmRhckNvbmZpZy51c2VyRGF5VGVtcGxhdGUpIHtcblx0ICAgICAgICAgICAgICAgICAgICAvLyBQdXQgdGhlIHVzZXIgdGVtcGxhdGUgaW50byB0aGUgY2FjaGVcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLiR0ZW1wbGF0ZUNhY2hlLnB1dCh0ZW1wbGF0ZUxvY2F0aW9uLCB0aGlzLmJjQ2FsZW5kYXJDb25maWcudXNlckRheVRlbXBsYXRlKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgICAgICAvLyBTdG9yZSB0aGUgaW5uZXItZGF5IHRlbXBsYXRlIG9uIHRoZSBzZXJ2aWNlXG5cdCAgICAgICAgICAgICAgICB0aGlzLmJjQ2FsZW5kYXJTZXJ2aWNlLnN0b3JlRGF5VGVtcGxhdGUodGVtcGxhdGVMb2NhdGlvbik7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAvLyBObyBjdXN0b20gdGVtcGxhdGUgd2FzIGRlZmluZWRcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBTdG9yZSB0aGUgaW5uZXItZGF5IHRlbXBsYXRlIG9uIHRoZSBzZXJ2aWNlXG5cdCAgICAgICAgICAgICAgICB0aGlzLmJjQ2FsZW5kYXJTZXJ2aWNlLnN0b3JlRGF5VGVtcGxhdGUodGhpcy5iY0NhbGVuZGFyQ29uZmlnLmRheVRlbXBsYXRlKTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgLy8gRGVmaW5lIHRoZSBkYXRlIGZvcm1hdCBmb3IgdGhlIGluZGl2aWR1YWwgZGF5XG5cdCAgICAgICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHRoaXMuYmNEYXRlRm9ybWF0IHx8IHRoaXMuYmNDYWxlbmRhckNvbmZpZy5kYXRlRm9ybWF0O1xuXHRcblx0ICAgICAgICAgICAgLy8gQnVpbGQgYXJyYXkgb2YgZGF5c1xuXHQgICAgICAgICAgICB2YXIgZGF5cyA9IHRoaXMuYmNDYWxlbmRhclNlcnZpY2UuYnVpbGREYXlzKHRoaXMuZGF5cywgdGhpcy5zdGFydERhdGUpO1xuXHRcblx0ICAgICAgICAgICAgLy8gQnVpbGQgdGhlIGNhbGVuZGFyIEpTT04gYW5kIGV4cG9zZSB0byB0aGUgRE9NXG5cdCAgICAgICAgICAgIHRoaXMuX2J1aWxkQ2FsZW5kYXIoZGF5cywgdGhpcy5uZXN0aW5nRGVwdGgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQ2hlY2sgdG8gc2VlIGlmIHRoZSBkYXkgaXMgcHJpb3IgdG8gdGhlIGN1cnJlbnQgZGF0ZVxuXHQgICAgICAgICAqIFRoaXMgaXMgdXNlZCB0byBkaXNhYmxlIHRoZSB1bnNlbGVjdGFibGUgZGF5c1xuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtEYXRlfSBkYXRlXG5cdCAgICAgICAgICogQHJldHVybiB7Qm9vbH1cblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnaXNCZWZvcmVUb2RheScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzQmVmb3JlVG9kYXkoZGF0ZSkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy5iY0NhbGVuZGFyU2VydmljZS5kYXRlSXNCZWZvcmVUb2RheShkYXRlKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIENoZWNrIHRvIHNlZSBpZiB0aGUgZGF5IG1hdGNoZXMgdGhlIGN1cnJlbnQgZGF0ZVxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtEYXRlfSBkYXRlXG5cdCAgICAgICAgICogQHJldHVybiB7Qm9vbH1cblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnaXNEYXlUb2RheScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzRGF5VG9kYXkoZGF0ZSkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy5iY0NhbGVuZGFyU2VydmljZS5pc0RheVRvZGF5KGRhdGUsIHRoaXMuc3RhcnREYXRlKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIFNlbGVjdCBhIGRhdGVcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXlcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnc2VsZWN0RGF0ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdERhdGUoZGF5KSB7XG5cdCAgICAgICAgICAgIC8vIFNldCB0aGUgc2VsZWN0ZWQgZGF5XG5cdCAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlID0gZGF5O1xuXHRcblx0ICAgICAgICAgICAgLy8gT25seSBjYWxsIHRoZSBwYXNzZWQgbWV0aG9kIGlmIGl0IGV4aXN0cyBhbmQgYSB2YWxpZCBkYXRlIHdhcyBjaG9zZW5cblx0ICAgICAgICAgICAgaWYgKGRheS5kYXRlICYmIHRoaXMuYmNEYXRlU2VsZWN0ZWQpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuYmNEYXRlU2VsZWN0ZWQoe1xuXHQgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRheS5kYXRlXG5cdCAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogRm9ybWF0IGEgZGF0ZSB1c2luZyBtb21lbnRcblx0ICAgICAgICAgKlxuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRlXG5cdCAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGZvcm1hdFxuXHQgICAgICAgICAqIEByZXR1cm4ge1N0cmluZ30gZm9ybWF0dGVkRGF0ZVxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdmb3JtYXREYXRlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlLCBmb3JtYXQpIHtcblx0ICAgICAgICAgICAgaWYgKCFkYXRlKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiBtb21lbnQoZGF0ZSkuZm9ybWF0KGZvcm1hdCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBCdWlsZCB0aGUgY2FsZW5kYXIgSlNPTlxuXHQgICAgICAgICAqXG5cdCAgICAgICAgICogQHBhcmFtIHtBcnJheX0gZGF5c1xuXHQgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkZXB0aFxuXHQgICAgICAgICAqIEByZXR1cm4ge0VsZW1lbnR9IGVsZW1lbnRcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnX2J1aWxkQ2FsZW5kYXInLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfYnVpbGRDYWxlbmRhcihkYXlzLCBkZXB0aCkge1xuXHRcblx0ICAgICAgICAgICAgLy8gQ2FsbCB0aGUgY29ycmVjdCBvcmdhbml6YXRpb24gbWV0aG9kIGJhc2VkIG9uIHRoZSBuZXN0aW5nIGRlcHRoXG5cdCAgICAgICAgICAgIGlmIChkZXB0aCA9PT0gJ21vbnRoJykge1xuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMuYmNDb2xsZWN0aW9uID0gdGhpcy5iY0NhbGVuZGFyU2VydmljZS5vcmdhbml6ZU1vbnRocyhkYXlzKTtcblx0ICAgICAgICAgICAgfSBlbHNlIGlmIChkZXB0aCA9PT0gJ3dlZWsnKSB7XG5cdFxuXHQgICAgICAgICAgICAgICAgdGhpcy5iY0NvbGxlY3Rpb24gPSB0aGlzLmJjQ2FsZW5kYXJTZXJ2aWNlLm9yZ2FuaXplV2Vla3MoZGF5cyk7XG5cdCAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVwdGggPT09ICdkYXknKSB7XG5cdFxuXHQgICAgICAgICAgICAgICAgdGhpcy5iY0NvbGxlY3Rpb24gPSBkYXlzO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBDYWxlbmRhckNvbnRyb2xsZXI7XG5cdH0oKTtcblxuLyoqKi8gfSxcbi8qIDYgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdHZhciBwYXRoID0gJy9Vc2Vycy9iYy9Db2RlL29wZW4tc291cmNlL2FuZ3VsYXItanNvbi1jYWxlbmRhci9zcmMvdGVtcGxhdGVzL2NhbGVuZGFyLmh0bWwnO1xuXHR2YXIgaHRtbCA9IFwiPHNlY3Rpb24gY2xhc3M9YmMtY2FsZW5kYXI+IDxzcGFuIGNsYXNzPWJjLWNhbGVuZGFyX193ZWVrZGF5cyBkYXRhLW5nLWlmPVxcXCIkY3RybC5zaG93V2Vla2RheXMgJiYgJGN0cmwubmVzdGluZ0RlcHRoID09PSAnd2VlaydcXFwiPiA8c3BhbiBjbGFzcz1cXFwiYmMtY2FsZW5kYXJfX2RheSBiYy1jYWxlbmRhcl9fZGF5LS13ZWVrZGF5c1xcXCIgZGF0YS1uZy1yZXBlYXQ9XFxcImRheSBpbiAkY3RybC53ZWVrZGF5cyB0cmFjayBieSAkaW5kZXhcXFwiPiA8c3Ryb25nIGNsYXNzPWJjLWNhbGVuZGFyX19kYXktdGl0bGU+IHt7IGRheSB9fSA8L3N0cm9uZz4gPC9zcGFuPiA8L3NwYW4+IDxiYy1tb250aCBkYXRhLW5nLWlmPVxcXCIkY3RybC5uZXN0aW5nRGVwdGggPT09ICdtb250aCdcXFwiIGNsYXNzPWJjLWNhbGVuZGFyX19tb250aC13cmFwcGVyIGJjLWNvbGxlY3Rpb249JGN0cmwuYmNDb2xsZWN0aW9uPjwvYmMtbW9udGg+IDxiYy13ZWVrIGRhdGEtbmctaWY9XFxcIiRjdHJsLm5lc3RpbmdEZXB0aCA9PT0gJ3dlZWsnXFxcIiBjbGFzcz1iYy1jYWxlbmRhcl9fd2Vlay13cmFwcGVyIGJjLWNvbGxlY3Rpb249JGN0cmwuYmNDb2xsZWN0aW9uPjwvYmMtd2Vlaz4gPGJjLWRheSBkYXRhLW5nLWlmPVxcXCIkY3RybC5uZXN0aW5nRGVwdGggPT09ICdkYXknXFxcIiBjbGFzcz1iYy1jYWxlbmRhcl9fZGF5LXdyYXBwZXIgYmMtY29sbGVjdGlvbj0kY3RybC5iY0NvbGxlY3Rpb24+PC9iYy1kYXk+IDwvc2VjdGlvbj5cIjtcblx0d2luZG93LmFuZ3VsYXIubW9kdWxlKCduZycpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oYykgeyBjLnB1dChwYXRoLCBodG1sKSB9XSk7XG5cdG1vZHVsZS5leHBvcnRzID0gcGF0aDtcblxuLyoqKi8gfSxcbi8qIDcgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdHZhciBwYXRoID0gJy9Vc2Vycy9iYy9Db2RlL29wZW4tc291cmNlL2FuZ3VsYXItanNvbi1jYWxlbmRhci9zcmMvdGVtcGxhdGVzL21vbnRoLmh0bWwnO1xuXHR2YXIgaHRtbCA9IFwiPHRpbWUgY2xhc3M9YmMtY2FsZW5kYXJfX21vbnRoIGRhdGV0aW1lPVxcXCJ7eyBtb250aFswXVttb250aFswXS5sZW5ndGggLSAxXS5kYXRlIHwgZGF0ZToneXl5eS1NTScgfX1cXFwiIGRhdGEtbmctcmVwZWF0PVxcXCJtb250aCBpbiB2bS5iY0NvbGxlY3Rpb24gdHJhY2sgYnkgJGluZGV4XFxcIj4gPHNwYW4gY2xhc3M9YmMtY2FsZW5kYXJfX21vbnRoLXRpdGxlIGRhdGEtbmctYmluZD1cXFwiJGN0cmwuZm9ybWF0RGF0ZShtb250aFswXVttb250aFswXS5sZW5ndGggLSAxXS5kYXRlLCAkY3RybC5tb250aFRpdGxlRm9ybWF0KVxcXCIgZGF0YS1uZy1pZj0kY3RybC5zaG93TW9udGhUaXRsZXM+PC9zcGFuPiA8c3BhbiBjbGFzcz1iYy1jYWxlbmRhcl9fd2Vla2RheXMgZGF0YS1uZy1pZj0kY3RybC5zaG93V2Vla2RheXM+IDxzcGFuIGNsYXNzPVxcXCJiYy1jYWxlbmRhcl9fZGF5IGJjLWNhbGVuZGFyX19kYXktLXdlZWtkYXlzXFxcIiBkYXRhLW5nLXJlcGVhdD1cXFwiZGF5IGluICRjdHJsLndlZWtkYXlzIHRyYWNrIGJ5ICRpbmRleFxcXCI+IDxzdHJvbmcgY2xhc3M9YmMtY2FsZW5kYXJfX2RheS10aXRsZT4ge3sgZGF5IH19IDwvc3Ryb25nPiA8L3NwYW4+IDwvc3Bhbj4gPGJjLXdlZWsgYmMtY29sbGVjdGlvbj1tb250aCBjbGFzcz1iYy1jYWxlbmRhcl9fd2Vlay13cmFwcGVyPjwvYmMtd2Vlaz4gPC90aW1lPlwiO1xuXHR3aW5kb3cuYW5ndWxhci5tb2R1bGUoJ25nJykucnVuKFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbihjKSB7IGMucHV0KHBhdGgsIGh0bWwpIH1dKTtcblx0bW9kdWxlLmV4cG9ydHMgPSBwYXRoO1xuXG4vKioqLyB9LFxuLyogOCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0dmFyIHBhdGggPSAnL1VzZXJzL2JjL0NvZGUvb3Blbi1zb3VyY2UvYW5ndWxhci1qc29uLWNhbGVuZGFyL3NyYy90ZW1wbGF0ZXMvd2Vlay5odG1sJztcblx0dmFyIGh0bWwgPSBcIjx0aW1lIGNsYXNzPWJjLWNhbGVuZGFyX193ZWVrIGRhdGV0aW1lPVxcXCJ7eyB3ZWVrW3dlZWsubGVuZ3RoIC0gMV0uZGF0ZSB8IGRhdGU6J3l5eXktd3cnIH19XFxcIiBkYXRhLW5nLXJlcGVhdD1cXFwid2VlayBpbiB2bS5iY0NvbGxlY3Rpb24gdHJhY2sgYnkgJGluZGV4XFxcIj4gPGJjLWRheSBiYy1jb2xsZWN0aW9uPXdlZWsgY2xhc3M9YmMtY2FsZW5kYXJfX2RheS13cmFwcGVyPjwvYmMtZGF5PiA8L3RpbWU+XCI7XG5cdHdpbmRvdy5hbmd1bGFyLm1vZHVsZSgnbmcnKS5ydW4oWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uKGMpIHsgYy5wdXQocGF0aCwgaHRtbCkgfV0pO1xuXHRtb2R1bGUuZXhwb3J0cyA9IHBhdGg7XG5cbi8qKiovIH0sXG4vKiA5ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHR2YXIgcGF0aCA9ICcvVXNlcnMvYmMvQ29kZS9vcGVuLXNvdXJjZS9hbmd1bGFyLWpzb24tY2FsZW5kYXIvc3JjL3RlbXBsYXRlcy9kYXkuaHRtbCc7XG5cdHZhciBodG1sID0gXCI8c3BhbiBjbGFzcz1iYy1jYWxlbmRhcl9fZGF5IGRhdGEtbmctY2xhc3M9XFxcInsgJ2JjLWNhbGVuZGFyX19kYXktLWRpc2FibGVkJzogJGN0cmwuaXNCZWZvcmVUb2RheShkYXkuZGF0ZSksXFxuICAgICAgICAgICAgICAgICAgICdiYy1jYWxlbmRhcl9fZGF5LS10b2RheSc6ICRjdHJsLmlzRGF5VG9kYXkoZGF5LmRhdGUpLFxcbiAgICAgICAgICAgICAgICAgICAnYmMtY2FsZW5kYXJfX2RheS0tZXZlbic6ICRldmVuLFxcbiAgICAgICAgICAgICAgICAgICAnYmMtY2FsZW5kYXJfX2RheS0tb2RkJzogJG9kZCxcXG4gICAgICAgICAgICAgICAgICAgJ2JjLWNhbGVuZGFyX19kYXktLXBhZCc6ICFkYXkuZGF0ZSxcXG4gICAgICAgICAgICAgICAgICAgJ2JjLWNhbGVuZGFyX19kYXktLXZhbGlkJzogZGF5LmRhdGUsXFxuICAgICAgICAgICAgICAgICAgICdiYy1jYWxlbmRhcl9fZGF5LS1zZWxlY3RlZCc6IGRheS5kYXRlID09PSAkY3RybC5zZWxlY3RlZERhdGUuZGF0ZSB9XFxcIiBkYXRhLW5nLWNsaWNrPSRjdHJsLnNlbGVjdERhdGUoZGF5KSBkYXRhLW5nLXJlcGVhdD1cXFwiZGF5IGluIHZtLmJjQ29sbGVjdGlvbiB0cmFjayBieSAkaW5kZXhcXFwiIHRpdGxlPVxcXCJ7eyBkYXkuZGF0ZSA/IGRheS5kYXRlIDogJycgfX1cXFwiIHRhYmluZGV4PVxcXCJ7eyBkYXkuZGF0ZSA/IDEgOiAtMSB9fVxcXCI+IDxuZy1pbmNsdWRlIHNyYz12bS5kYXlUZW1wbGF0ZT48L25nLWluY2x1ZGU+IDwvc3Bhbj5cIjtcblx0d2luZG93LmFuZ3VsYXIubW9kdWxlKCduZycpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oYykgeyBjLnB1dChwYXRoLCBodG1sKSB9XSk7XG5cdG1vZHVsZS5leHBvcnRzID0gcGF0aDtcblxuLyoqKi8gfSxcbi8qIDEwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLmJjTW9udGhEaXJlY3RpdmUgPSBiY01vbnRoRGlyZWN0aXZlO1xuXHRcblx0dmFyIF9tb250aCA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cdFxuXHR2YXIgX21vbnRoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21vbnRoKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBiY01vbnRoRGlyZWN0aXZlKCkge1xuXHQgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICB2YXIgZGlyZWN0aXZlID0ge1xuXHQgICAgICAgIHJlc3RyaWN0OiAnRScsXG5cdCAgICAgICAgc2NvcGU6IHRydWUsXG5cdCAgICAgICAgYmluZFRvQ29udHJvbGxlcjoge1xuXHQgICAgICAgICAgICBiY0NvbGxlY3Rpb246ICc9Jyxcblx0ICAgICAgICAgICAgYmNXZWVrZGF5c0hlYWRlcjogJz0nXG5cdCAgICAgICAgfSxcblx0ICAgICAgICB0ZW1wbGF0ZVVybDogX21vbnRoMi5kZWZhdWx0LFxuXHQgICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uIGNvbnRyb2xsZXIoKSB7fSxcblx0ICAgICAgICBjb250cm9sbGVyQXM6ICd2bSdcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIGRpcmVjdGl2ZTtcblx0fVxuXG4vKioqLyB9LFxuLyogMTEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuYmNXZWVrRGlyZWN0aXZlID0gYmNXZWVrRGlyZWN0aXZlO1xuXHRcblx0dmFyIF93ZWVrID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblx0XG5cdHZhciBfd2VlazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF93ZWVrKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBiY1dlZWtEaXJlY3RpdmUoKSB7XG5cdCAgICAnbmdJbmplY3QnO1xuXHRcblx0ICAgIHZhciBkaXJlY3RpdmUgPSB7XG5cdCAgICAgICAgcmVzdHJpY3Q6ICdFJyxcblx0ICAgICAgICBzY29wZTogdHJ1ZSxcblx0ICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB7XG5cdCAgICAgICAgICAgIGJjQ29sbGVjdGlvbjogJz0nXG5cdCAgICAgICAgfSxcblx0ICAgICAgICB0ZW1wbGF0ZVVybDogX3dlZWsyLmRlZmF1bHQsXG5cdCAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24gY29udHJvbGxlcigpIHt9LFxuXHQgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gZGlyZWN0aXZlO1xuXHR9XG5cbi8qKiovIH0sXG4vKiAxMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0YmNEYXlEaXJlY3RpdmUuJGluamVjdCA9IFtcImJjQ2FsZW5kYXJDb25maWdcIl07XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuYmNEYXlEaXJlY3RpdmUgPSBiY0RheURpcmVjdGl2ZTtcblx0XG5cdHZhciBfZGF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0XG5cdHZhciBfZGF5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RheSk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gYmNEYXlEaXJlY3RpdmUoYmNDYWxlbmRhckNvbmZpZykge1xuXHQgICAgJ25nSW5qZWN0Jztcblx0XG5cdCAgICB2YXIgZGlyZWN0aXZlID0ge1xuXHQgICAgICAgIHJlc3RyaWN0OiAnRScsXG5cdCAgICAgICAgc2NvcGU6IHRydWUsXG5cdCAgICAgICAgYmluZFRvQ29udHJvbGxlcjoge1xuXHQgICAgICAgICAgICBiY0NvbGxlY3Rpb246ICc9J1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgdGVtcGxhdGVVcmw6IF9kYXkyLmRlZmF1bHQsXG5cdCAgICAgICAgY29udHJvbGxlcjogW1wiYmNDYWxlbmRhclNlcnZpY2VcIiwgZnVuY3Rpb24gY29udHJvbGxlcihiY0NhbGVuZGFyU2VydmljZSkge1xuXHQgICAgICAgICAgICAnbmdJbmplY3QnO1xuXHRcblx0ICAgICAgICAgICAgLy8gR2V0IHRoZSBpbm5lci1kYXkgdGVtcGxhdGUgZnJvbSB0aGUgc2VydmljZVxuXHRcblx0ICAgICAgICAgICAgdGhpcy5kYXlUZW1wbGF0ZSA9IGJjQ2FsZW5kYXJTZXJ2aWNlLmdldERheVRlbXBsYXRlKCk7XG5cdCAgICAgICAgfV0sXG5cdCAgICAgICAgY29udHJvbGxlckFzOiAndm0nXG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBkaXJlY3RpdmU7XG5cdH1cblxuLyoqKi8gfVxuLyoqKioqKi8gXSlcbn0pO1xuO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIGFuZ3VsYXItanNvbi1jYWxlbmRhci5taW4uanNcbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIDIyM2FiMWJmZWQxNDZiZWI5YWIzXG4gKiovIiwiaW1wb3J0IHsgYmNDYWxlbmRhckNvbmZpZyB9IGZyb20gJy4vY2FsZW5kYXIucHJvdmlkZXInO1xuaW1wb3J0IHsgYmNDYWxlbmRhclNlcnZpY2UgfSBmcm9tICcuL2NhbGVuZGFyLnNlcnZpY2UnO1xuaW1wb3J0IHsgYmNDYWxlbmRhckRpcmVjdGl2ZSB9IGZyb20gJy4vY2FsZW5kYXIuZGlyZWN0aXZlJztcbmltcG9ydCB7IGJjTW9udGhEaXJlY3RpdmUgfSBmcm9tICcuL21vbnRoLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBiY1dlZWtEaXJlY3RpdmUgfSBmcm9tICcuL3dlZWsuZGlyZWN0aXZlJztcbmltcG9ydCB7IGJjRGF5RGlyZWN0aXZlIH0gZnJvbSAnLi9kYXkuZGlyZWN0aXZlJztcblxuZXhwb3J0IGRlZmF1bHQgYW5ndWxhci5tb2R1bGUoJ2JjLkpzb25DYWxlbmRhcicsIFtdKVxuICAgIC5wcm92aWRlcignYmNDYWxlbmRhckNvbmZpZycsIGJjQ2FsZW5kYXJDb25maWcpXG4gICAgLnNlcnZpY2UoJ2JjQ2FsZW5kYXJTZXJ2aWNlJywgYmNDYWxlbmRhclNlcnZpY2UpXG4gICAgLmRpcmVjdGl2ZSgnYmNDYWxlbmRhcicsIGJjQ2FsZW5kYXJEaXJlY3RpdmUpXG4gICAgLmRpcmVjdGl2ZSgnYmNNb250aCcsIGJjTW9udGhEaXJlY3RpdmUpXG4gICAgLmRpcmVjdGl2ZSgnYmNXZWVrJywgYmNXZWVrRGlyZWN0aXZlKVxuICAgIC5kaXJlY3RpdmUoJ2JjRGF5JywgYmNEYXlEaXJlY3RpdmUpXG47XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2luZGV4LmpzXG4gKiovIiwiaW1wb3J0IGRheVRlbXBsYXRlIGZyb20gJy4vdGVtcGxhdGVzL2RheS5pbm5lci5odG1sJztcblxuZXhwb3J0IGNsYXNzIGJjQ2FsZW5kYXJDb25maWcge1xuXG4gICAgLy8gRGVmaW5lIGRlZmF1bHRzXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICduZ0luamVjdCc7XG5cbiAgICAgICAgLy8gVGhlIGNhbGVuZGFyIHdpbGwgYmVnaW4gd2l0aCB0b2RheVxuICAgICAgICB0aGlzLnN0YXJ0RGF0ZSA9IG1vbWVudChuZXcgRGF0ZSgpKS5zdGFydE9mKCdkYXknKS5mb3JtYXQoKTtcblxuICAgICAgICAvLyBUaGUgZGVmYXVsdCBpbnRlcnZhbCB0eXBlIFtkYXl8d2Vla3xtb250aF1cbiAgICAgICAgdGhpcy5uZXN0aW5nRGVwdGggPSAnbW9udGgnO1xuXG4gICAgICAgIC8vIEhvdyBtYW55IGRheXMgc2hvdWxkIGJlIGdlbmVyYXRlZFxuICAgICAgICB0aGlzLmRheXMgPSAzMDtcblxuICAgICAgICAvLyBEZWZpbmUgdGhlIGRpZmZlcmVudCBwb3NzaWJsZSByZXByZXNlbnRhdGlvbnMgb2YgdGhlIHdlZWtkYXlcbiAgICAgICAgdGhpcy53ZWVrZGF5U3R5bGUgPSB7XG4gICAgICAgICAgICBsZXR0ZXI6IFtcbiAgICAgICAgICAgICAgICAnUycsXG4gICAgICAgICAgICAgICAgJ00nLFxuICAgICAgICAgICAgICAgICdUJyxcbiAgICAgICAgICAgICAgICAnVycsXG4gICAgICAgICAgICAgICAgJ1QnLFxuICAgICAgICAgICAgICAgICdGJyxcbiAgICAgICAgICAgICAgICAnUycsXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgYWJicmV2aWF0aW9uOiBbXG4gICAgICAgICAgICAgICAgJ1N1bicsXG4gICAgICAgICAgICAgICAgJ01vbicsXG4gICAgICAgICAgICAgICAgJ1R1ZScsXG4gICAgICAgICAgICAgICAgJ1dlZCcsXG4gICAgICAgICAgICAgICAgJ1RodXInLFxuICAgICAgICAgICAgICAgICdGcmknLFxuICAgICAgICAgICAgICAgICdTYXQnLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIHdvcmQ6IFtcbiAgICAgICAgICAgICAgICAnU3VuZGF5JyxcbiAgICAgICAgICAgICAgICAnTW9uZGF5JyxcbiAgICAgICAgICAgICAgICAnVHVlc2RheScsXG4gICAgICAgICAgICAgICAgJ1dlZG5lc2RheScsXG4gICAgICAgICAgICAgICAgJ1RodXJzZGF5JyxcbiAgICAgICAgICAgICAgICAnRnJpZGF5JyxcbiAgICAgICAgICAgICAgICAnU2F0dXJkYXknLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBTZXQgdGhlIGRlZmF1bHQgd29yZCB0eXBlIChNIHZzIE1vbiB2cyBNb25kYXkpXG4gICAgICAgIHRoaXMuZGF5VGl0bGVGb3JtYXQgPSAnYWJicmV2aWF0aW9uJztcblxuICAgICAgICAvLyBTaG91bGQgdGhlIGNhbGVuZGFyIHNob3cgdGhlIHdlZWtkYXkgbmFtZXMgYWJvdmUgZWFjaCBjb2x1bW4/XG4gICAgICAgIHRoaXMuc2hvd1dlZWtkYXlzID0gdHJ1ZTtcblxuICAgICAgICAvLyBEZWZpbmUgdGhlIGRlZmF1bHQgdGVtcGxhdGUgZm9yIGEgZGF5XG4gICAgICAgIHRoaXMuZGF5VGVtcGxhdGUgPSBkYXlUZW1wbGF0ZTtcblxuICAgICAgICAvLyBBbGxvdyB0aGUgdXNlciB0byBzZXQgYSBjdXN0b20gdGVtcGxhdGVcbiAgICAgICAgdGhpcy5zZXREYXlUZW1wbGF0ZSA9ICh0ZW1wbGF0ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy51c2VyRGF5VGVtcGxhdGUgPSB0ZW1wbGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlZmluZSB0aGUgZGVmYXVsdCBmb3JtYXQgZm9yIGEgZGF5XG4gICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9ICdEJztcblxuICAgICAgICAvLyBEZWZpbmUgdGhlIGRlZmF1bHQgZm9ybWF0IGZvciBhIG1vbnRoIHRpdGxlXG4gICAgICAgIHRoaXMubW9udGhUaXRsZUZvcm1hdCA9ICdNTU1NJ1xuXG4gICAgICAgIC8vIFNob3VsZCBtb250aCB0aXRsZXMgYmUgc2hvd24gYnkgZGVmYXVsdD9cbiAgICAgICAgdGhpcy5zaG93TW9udGhUaXRsZXMgPSB0cnVlO1xuXG4gICAgfVxuXG5cblxuXG4gICAgJGdldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG5cbn1cblxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvY2FsZW5kYXIucHJvdmlkZXIuanNcbiAqKi8iLCJ2YXIgcGF0aCA9ICcvVXNlcnMvYmMvQ29kZS9vcGVuLXNvdXJjZS9hbmd1bGFyLWpzb24tY2FsZW5kYXIvc3JjL3RlbXBsYXRlcy9kYXkuaW5uZXIuaHRtbCc7XG52YXIgaHRtbCA9IFwiPHRpbWUgZGF0ZXRpbWU9XFxcInt7IGRheS5kYXRlIHwgZGF0ZToneXl5eS1NTS1kZCcgfX1cXFwiIGNsYXNzPWJjLWNhbGVuZGFyX19kYXktdGltZSB0aXRsZT1cXFwie3sgZGF5LmRhdGUgfX1cXFwiIGRhdGEtbmctaWY9ZGF5LmRhdGU+IDxzcGFuIGRhdGEtbmctYmluZD1cXFwiJGN0cmwuZm9ybWF0RGF0ZShkYXkuZGF0ZSwgJGN0cmwuZGF0ZUZvcm1hdClcXFwiPjwvc3Bhbj4gPC90aW1lPlwiO1xud2luZG93LmFuZ3VsYXIubW9kdWxlKCduZycpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oYykgeyBjLnB1dChwYXRoLCBodG1sKSB9XSk7XG5tb2R1bGUuZXhwb3J0cyA9IHBhdGg7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy90ZW1wbGF0ZXMvZGF5LmlubmVyLmh0bWxcbiAqKiBtb2R1bGUgaWQgPSAyXG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyIsImV4cG9ydCBjbGFzcyBiY0NhbGVuZGFyU2VydmljZSB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICApIHtcbiAgICAgICAgJ25nSW5qZWN0JztcblxuICAgICAgICB0aGlzLldFRUtfTEVOR1RIID0gNztcbiAgICAgICAgdGhpcy5kYXlUZW1wbGF0ZTtcblxuICAgIH1cblxuXG5cblxuICAgIC8qKlxuICAgICAqIENoZWNrIHRvIHNlZSBpZiB0aGUgZGF5IGlzIHByaW9yIHRvIHRoZSBjdXJyZW50IGRhdGVcbiAgICAgKiBUaGlzIGlzIHVzZWQgdG8gZGlzYWJsZSB0aGUgdW5zZWxlY3RhYmxlIGRheXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRlXG4gICAgICogQHJldHVybiB7Qm9vbH0gaXNCZWZvcmVcbiAgICAgKi9cbiAgICBkYXRlSXNCZWZvcmVUb2RheShkYXRlKSB7XG4gICAgICAgIGNvbnN0IHRvZGF5ID0gbW9tZW50KG5ldyBEYXRlKCkpLnN0YXJ0T2YoJ2RheScpLmZvcm1hdCgpO1xuXG4gICAgICAgIHJldHVybiBtb21lbnQoZGF0ZSkuaXNCZWZvcmUodG9kYXkpO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgdG8gc2VlIGlmIHRoZSBkYXkgbWF0Y2hlcyB0aGUgY3VycmVudCBkYXRlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRlMlxuICAgICAqIEByZXR1cm4ge0Jvb2x9IGlzVG9kYXlcbiAgICAgKi9cbiAgICBpc0RheVRvZGF5KGRhdGUsIGRhdGUyID0gbW9tZW50KG5ldyBEYXRlKCkpLmZvcm1hdCgpKSB7XG4gICAgICAgIHJldHVybiBtb21lbnQoZGF0ZSkuaXNTYW1lKGRhdGUyKTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFR1cm4gYSBpbnRlZ2VyIChlLmcuICc2JykgaW50byBhbiBhcnJheTogJ1sxLDIsMyw0LDUsNl0nXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0ludGVnZXJ9IGNvdW50XG4gICAgICogQHJldHVybiB7QXJyYXl9IGRheXNcbiAgICAgKi9cbiAgICBpbnRlZ2VyVG9BcnJheShjb3VudCkge1xuICAgICAgICBsZXQgaTtcbiAgICAgICAgY29uc3QgZGF5cyA9IFtdO1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSArPSAxKSB7XG4gICAgICAgICAgICBkYXlzLnB1c2goaSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGF5cztcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFBhZCB0aGUgYmVnaW5uaW5nIG9mIGEgd2Vla1xuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0YXJ0RGF0ZSAtIGRhdGUgdG8gdG8gd29yayBiYWNrIGZyb21cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBjb3VudCAtIGhvdyBtYW55IGRheXMgdG8gcGFkXG4gICAgICogQHJldHVybiB7QXJyYXl9IHBhZFxuICAgICAqL1xuICAgIHBhZERheXNMZWZ0KHN0YXJ0RGF0ZSwgY291bnQpIHtcbiAgICAgICAgY29uc3QgcGFkID0gW107XG4gICAgICAgIGNvbnN0IG1pc3NpbmdEYXlzID0gdGhpcy5pbnRlZ2VyVG9BcnJheShjb3VudCk7XG5cbiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIG1pc3NpbmcgZGF5c1xuICAgICAgICBmb3IgKGNvbnN0IGRheSBpbiBtaXNzaW5nRGF5cykge1xuICAgICAgICAgICAgLy8gSG93IG1hbnkgZGF5cyB0byBnbyBiYWNrXG4gICAgICAgICAgICBjb25zdCBzdWJ0cmFjdGlvbiA9IHBhcnNlSW50KGRheSwgMTApICsgMTtcblxuICAgICAgICAgICAgLy8gRmluZCB0aGF0IGRheVxuICAgICAgICAgICAgY29uc3QgcHJldmlvdXMgPSBtb21lbnQoc3RhcnREYXRlKS5zdWJ0cmFjdCgoc3VidHJhY3Rpb24pLCAnZGF5cycpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICAgICAgICAgIC8vIEFkZCB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBhcnJheVxuICAgICAgICAgICAgcGFkLnVuc2hpZnQoe1xuICAgICAgICAgICAgICAgIGRhdGU6IHByZXZpb3VzLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcGFkO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogUGFkIGEgY29sbGVjdGlvbiB3aXRoIGJsYW5rIHRpbGVzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBjb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtJbnRlZ2VyfSBjb3VudFxuICAgICAqIEByZXR1cm4ge0FycmF5fSBwYWRkZWRDb2xsZWN0aW9uXG4gICAgICovXG4gICAgcGFkQmxhbmtUaWxlcyhjb2xsZWN0aW9uLCBjb3VudCwgZGlyZWN0aW9uID0gJ2xlZnQnKSB7XG4gICAgICAgIGxldCBpO1xuICAgICAgICBjb25zdCBkYXlzID0gW107XG5cbiAgICAgICAgLy8gQ3JlYXRlIGFycmF5XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb3VudDsgaSArPSAxKSB7XG4gICAgICAgICAgICBkYXlzLnB1c2goe1xuICAgICAgICAgICAgICAgIGRhdGU6IG51bGwsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIGRpcmVjdGlvbiBpcyAncmlnaHQnXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcbiAgICAgICAgICAgIC8vIHBhZCB0aGUgZW5kXG4gICAgICAgICAgICByZXR1cm4gY29sbGVjdGlvbi5jb25jYXQoZGF5cyk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnbGVmdCcpIHtcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBwYWQgdGhlIGJlZ2lubmluZ1xuICAgICAgICAgICAgcmV0dXJuIGRheXMuY29uY2F0KGNvbGxlY3Rpb24pO1xuICAgICAgICB9XG5cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFNwbGl0IGFuIGFycmF5IGludG8gY2h1bmtzIGFuZCByZXR1cm4gYW4gYXJyYXkgb2YgdGhlc2UgY2h1bmtzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBncm91cFxuICAgICAqIEBwYXJhbSB7SW50ZWdlcn0gZ3JvdXBzaXplIC0gQ2h1bmsgc2l6ZS4gRGVmYXVsdHMgdG8gNyAob25lIHdlZWspLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBjaHVua3NcbiAgICAgKi9cbiAgICBjaHVuayhncm91cCwgZ3JvdXBzaXplID0gdGhpcy5XRUVLX0xFTkdUSCkge1xuICAgICAgICBjb25zdCBzZXRzID0gW107XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgY29uc3QgY2h1bmtzID0gZ3JvdXAubGVuZ3RoIC8gcGFyc2VJbnQoZ3JvdXBzaXplLCAxMCk7XG5cbiAgICAgICAgd2hpbGUoaSA8IGNodW5rcykge1xuICAgICAgICAgICAgc2V0c1tpXSA9IGdyb3VwLnNwbGljZSgwLCBncm91cHNpemUpO1xuICAgICAgICAgICAgaSA9IGkgKyAxO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNldHM7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGR1cmF0aW9uIGluIGRheXMgYmV0d2VlbiB0d28gZGF0ZXMgSU5DTFVESU5HIGJvdGggZGF0ZXNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdGFydFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBlbmRcbiAgICAgKiBAcmV0dXJuIHtJbnRlZ2VyfSBkYXlzXG4gICAgICovXG4gICAgZHVyYXRpb25JbkRheXMoc3RhcnQsIGVuZCkge1xuICAgICAgICBjb25zdCBuZXdTdGFydCA9IG1vbWVudChzdGFydCkuc3RhcnRPZignZGF5Jyk7XG4gICAgICAgIC8vIEFkZCBhIGRheSBzbyB0aGUgZW5kIGRhdGUgaXMgaW5jbHVkZWQgaW4gdGhlIGNhbGN1bGF0aW9uXG4gICAgICAgIGNvbnN0IG5ld0VuZCA9IG1vbWVudChlbmQpLnN0YXJ0T2YoJ2RheScpLmFkZCgxLCAnZGF5cycpO1xuXG4gICAgICAgIHJldHVybiBuZXdFbmQuZGlmZihuZXdTdGFydCwgICdkYXlzJyk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBPcmdhbml6ZSBhIGNvbGxlY3Rpb24gb2YgZGF5cyBpbnRvIHN1YiBjb2xsZWN0aW9ucyBvZiB3ZWVrc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gZGF5cyAtIGFycmF5IG9mIGRheXNcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gY29sbGVjdGlvblxuICAgICAqL1xuICAgIG9yZ2FuaXplV2Vla3MoZGF5cykge1xuICAgICAgICAvLyBEZXRlcm1pbmUgdGhlIGRheSBvZiB0aGUgd2VlayB0aGF0IHRoZSBjYWxlbmRhciBzdGFydHMgYW5kIGVuZHMgb25cbiAgICAgICAgY29uc3QgZmlyc3REYXkgPSBtb21lbnQoZGF5c1swXS5kYXRlKS5kYXkoKTtcbiAgICAgICAgY29uc3QgbGFzdERheSA9IG1vbWVudChkYXlzW2RheXMubGVuZ3RoIC0gMV0uZGF0ZSkuZGF5KCk7XG4gICAgICAgIGNvbnN0IFNBVFVSREFZID0gNjtcbiAgICAgICAgY29uc3QgU1VOREFZID0gMDtcblxuICAgICAgICAvLyBJZiB0aGUgZmlyc3QgZGF5IGlzIGFmdGVyIFN1bmRheVxuICAgICAgICBpZiAoZmlyc3REYXkgPiBTVU5EQVkpIHtcbiAgICAgICAgICAgIC8vIFBhZCB3aXRoIGJsYW5rIHRpbGVzIHNvIHRoZSBmaXJzdCBkYXkgaXMgbGluZWQgdXAgaW4gdGhlIGNvcnJlY3Qgd2Vla2RheSBjb2x1bW5cbiAgICAgICAgICAgIGRheXMgPSB0aGlzLnBhZEJsYW5rVGlsZXMoZGF5cywgZmlyc3REYXksICdsZWZ0Jyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB0aGUgbGFzdCBkYXkgaXMgYmVmb3JlIFNhdHVyZGF5XG4gICAgICAgIGlmIChsYXN0RGF5IDwgU0FUVVJEQVkpIHtcbiAgICAgICAgICAgIC8vIFBhZCB3aXRoIGJsYW5rIHRpbGVzIHNvIHRoYXQgdGhlIGxhc3Qgd2VlaydzIGRheXMgYXJlIGluIHRoZSBjb3JyZWN0IHdlZWtkYXkgY29sdW1uXG4gICAgICAgICAgICBkYXlzID0gdGhpcy5wYWRCbGFua1RpbGVzKGRheXMsdGhpcy5XRUVLX0xFTkdUSCAtIChsYXN0RGF5ICsgMSksICdyaWdodCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY2h1bmsoZGF5cyk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBPcmdhbml6ZSBieSBtb250aFxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gYWxsRGF5cyAtIEFuIGFycmF5IG9mIGFsbCBkYXlzXG4gICAgICogQHJldHVybiB7QXJyYXl9IGNvbGxlY3Rpb24gLSBkYXlzIG9yZ2FuaXplZCBpbnRvIHdlZWtzIGFuZCBtb250aHNcbiAgICAgKi9cbiAgICBvcmdhbml6ZU1vbnRocyhhbGxEYXlzKSB7XG4gICAgICAgIGNvbnN0IGNhbGVuZGFyID0gW107XG4gICAgICAgIGNvbnN0IFNBVFVSREFZID0gNjtcbiAgICAgICAgY29uc3QgU1VOREFZID0gMDtcbiAgICAgICAgbGV0IGNvbGxlY3Rpb24gPSBhbGxEYXlzO1xuICAgICAgICBsZXQgbW9udGg7XG4gICAgICAgIGxldCBkYXlPZk1vbnRoID0gbW9tZW50KGNvbGxlY3Rpb25bMF0uZGF0ZSkuZGF0ZSgpO1xuICAgICAgICBsZXQgZGF5c0luTW9udGggPSBtb21lbnQoY29sbGVjdGlvblswXS5kYXRlKS5kYXlzSW5Nb250aCgpO1xuXG4gICAgICAgIC8vIFBhZCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBtb250aCB3aXRoIGFueSBtaXNzaW5nIGRheXNcbiAgICAgICAgLy8gSWYgdGhlIGZpcnN0IGRheSBpcyBub3QgdGhlIGZpcnN0IGRheSBvZiB0aGUgbW9udGhcbiAgICAgICAgaWYgKG1vbWVudChjb2xsZWN0aW9uWzBdLmRhdGUpLmRhdGUoKSA+IDApIHtcbiAgICAgICAgICAgIC8vIFB1bGwgdGhpcyBtb250aCdzIGRheXMgZnJvbSB0aGUgY29sbGVjdGlvblxuICAgICAgICAgICAgbW9udGggPSBjb2xsZWN0aW9uLnNsaWNlKDAsIChkYXlzSW5Nb250aCAtIChkYXlPZk1vbnRoIC0gMSkpKTtcblxuICAgICAgICAgICAgLy8gRmlsbCB0aGUgbWlzc2luZyBkYXlzIGZyb20gdGhlIG1vbnRoXG4gICAgICAgICAgICBjb25zdCBwYWQgPSB0aGlzLnBhZERheXNMZWZ0KG1vbnRoWzBdLmRhdGUsIChkYXlPZk1vbnRoIC0gMSkpO1xuXG4gICAgICAgICAgICAvLyBDb21iaW5lIHdpdGggdGhlIGV4aXN0aW5nIGFycmF5XG4gICAgICAgICAgICBjb2xsZWN0aW9uID0gcGFkLmNvbmNhdChjb2xsZWN0aW9uKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy8gU3BsaXQgaW50byBtb250aHNcbiAgICAgICAgLy8gQXMgbG9uZyBhcyB0aGVyZSBhcmUgZGF5cyBsZWZ0IGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICAgIHdoaWxlIChjb2xsZWN0aW9uLmxlbmd0aCA+IDApIHtcblxuICAgICAgICAgICAgLy8gR2V0IHRoZSBkYXkgb2YgdGhlIG1vbnRoIGZvciB0aGUgZmlyc3QgZGF0ZSBvZiB0aGUgY29sbGVjdGlvbiBlZy4gJzI0J1xuICAgICAgICAgICAgZGF5T2ZNb250aCA9IG1vbWVudChjb2xsZWN0aW9uWzBdLmRhdGUpLmRhdGUoKTtcblxuICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIGhvdyBtYW55IGRheXMgdGhlcmUgYXJlIHRoaXMgbW9udGggKHRvdGFsKVxuICAgICAgICAgICAgZGF5c0luTW9udGggPSBtb21lbnQoY29sbGVjdGlvblswXS5kYXRlKS5kYXlzSW5Nb250aCgpO1xuXG4gICAgICAgICAgICAvLyBQdWxsIHRoaXMgbW9udGgncyBkYXlzIGZyb20gdGhlIGNvbGxlY3Rpb25cbiAgICAgICAgICAgIG1vbnRoID0gY29sbGVjdGlvbi5zcGxpY2UoMCwgKGRheXNJbk1vbnRoIC0gKGRheU9mTW9udGggLSAxKSkpO1xuXG4gICAgICAgICAgICAvLyBIb3cgbWFueSB3ZWVrZGF5cyBhcmUgcHJpb3IgdG8gdGhlIGZpcnN0IGRheSBvZiB0aGlzIG1vbnRoP1xuICAgICAgICAgICAgY29uc3QgZmlyc3REYXkgPSBtb21lbnQobW9udGhbMF0uZGF0ZSkuZGF5KCk7XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSBmaXJzdCBkYXkgaXMgYWZ0ZXIgU3VuZGF5XG4gICAgICAgICAgICBpZiAoZmlyc3REYXkgPiBTVU5EQVkpIHtcbiAgICAgICAgICAgICAgICAvLyBQYWQgd2l0aCBibGFuayB0aWxlcyBzbyB0aGF0IHRoZSBmaXJzdCBkYXkgaXMgbGluZWQgdXAgaW4gdGhlIGNvcnJlY3QgY29sdW1uXG4gICAgICAgICAgICAgICAgbW9udGggPSB0aGlzLnBhZEJsYW5rVGlsZXMobW9udGgsIGZpcnN0RGF5LCAnbGVmdCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBIb3cgbWFueSB3ZWVrZGF5cyBhcmUgYWZ0ZXIgdGhlIGxhc3QgZGF5IG9mIHRoZSBtb250aD9cbiAgICAgICAgICAgIC8vIChyZW1lbWJlcjogd2Vla3MgYXJlIHplcm8tYmFzZWQpXG4gICAgICAgICAgICBjb25zdCBsYXN0RGF5ID0gbW9tZW50KG1vbnRoW21vbnRoLmxlbmd0aCAtIDFdLmRhdGUpLmRheSgpO1xuXG4gICAgICAgICAgICAvLyBJZiBibGFuayB0aWxlcyBhcmUgbmVlZGVkIGZvciB0aGUgbGFzdCB3ZWVrXG4gICAgICAgICAgICBpZiAobGFzdERheSA8IFNBVFVSREFZKSB7XG4gICAgICAgICAgICAgICAgLy8gUGFkIHdpdGggYmxhbmsgdGlsZXMgc28gdGhhdCB0aGUgZmlyc3QgZGF5IGlzIGxpbmVkIHVwIGluIHRoZSBjb3JyZWN0IGNvbHVtblxuICAgICAgICAgICAgICAgIG1vbnRoID0gdGhpcy5wYWRCbGFua1RpbGVzKG1vbnRoLCB0aGlzLldFRUtfTEVOR1RIIC0gKGxhc3REYXkgKyAxKSwgJ3JpZ2h0Jyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIE9yZ2FuaXplIGludG8gd2Vla3MgYW5kIGFkZCB0byB0aGUgY2FsZW5kYXIgYXJyYXlcbiAgICAgICAgICAgIGNhbGVuZGFyLnB1c2godGhpcy5jaHVuayhtb250aCkpO1xuXG4gICAgICAgIH1cblxuXG4gICAgICAgIHJldHVybiBjYWxlbmRhcjtcblxuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgYW4gYXJyYXkgb2YgZGF5c1xuICAgICAqXG4gICAgICogQHBhcmFtIHtJbnRlZ2VyfSBsaW1pdCAtIGhvdyBtYW55IGRheXMgdG8gY3JlYXRlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0YXJ0IC0gdGhlIHN0YXJ0aW5nIGRhdGVcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gZGF5c1xuICAgICAqL1xuICAgIGJ1aWxkRGF5cyhsaW1pdCwgc3RhcnQgPSBuZXcgRGF0ZSgpKSB7XG4gICAgICAgIGxldCBjb3VudGVyID0gMDtcbiAgICAgICAgY29uc3QgZGF5cyA9IFtdO1xuICAgICAgICBsZXQgZGF5O1xuXG4gICAgICAgIHdoaWxlIChjb3VudGVyIDwgbGltaXQpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgZGF5XG4gICAgICAgICAgICBkYXkgPSBtb21lbnQoc3RhcnQpLmFkZChjb3VudGVyLCAnZGF5cycpLnRvSVNPU3RyaW5nKCk7XG5cbiAgICAgICAgICAgIC8vIEFkZCB0byB0aGUgYXJyYXlcbiAgICAgICAgICAgIGRheXMucHVzaCh7XG4gICAgICAgICAgICAgICAgZGF0ZTogZGF5LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEluY3JlbWVudCB0aGUgY291bnRlclxuICAgICAgICAgICAgY291bnRlciA9IGNvdW50ZXIgKyAxO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRheXM7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGlubmVyIGRheSB0ZW1wbGF0ZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHRlbXBsYXRlXG4gICAgICovXG4gICAgc3RvcmVEYXlUZW1wbGF0ZSh0ZW1wbGF0ZSkge1xuICAgICAgICB0aGlzLmRheVRlbXBsYXRlID0gdGVtcGxhdGU7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGlubmVyIGRheSB0ZW1wbGF0ZVxuICAgICAqXG4gICAgICogQHJldHVybiB7U3RyaW5nfSB0ZW1wbGF0ZVxuICAgICAqL1xuICAgIGdldERheVRlbXBsYXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXlUZW1wbGF0ZTtcbiAgICB9XG5cblxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jYWxlbmRhci5zZXJ2aWNlLmpzXG4gKiovIiwiaW1wb3J0IHsgQ2FsZW5kYXJDb250cm9sbGVyIH0gZnJvbSAnLi9jYWxlbmRhci5jb250cm9sbGVyJztcbmltcG9ydCBjYWxlbmRhclRlbXBsYXRlIGZyb20gJy4vdGVtcGxhdGVzL2NhbGVuZGFyLmh0bWwnO1xuaW1wb3J0IG1vbnRoVGVtcGxhdGUgZnJvbSAnLi90ZW1wbGF0ZXMvbW9udGguaHRtbCc7XG5pbXBvcnQgd2Vla1RlbXBsYXRlIGZyb20gJy4vdGVtcGxhdGVzL3dlZWsuaHRtbCc7XG5pbXBvcnQgZGF5VGVtcGxhdGUgZnJvbSAnLi90ZW1wbGF0ZXMvZGF5Lmh0bWwnO1xuXG5leHBvcnQgZnVuY3Rpb24gYmNDYWxlbmRhckRpcmVjdGl2ZShcbikge1xuICAgICduZ0luamVjdCc7XG5cbiAgICAvLyBEZWZpbmUgcG9zc2libGUgdGVtcGxhdGVzXG4gICAgY29uc3QgdGVtcGxhdGVzID0ge1xuICAgICAgICBtb250aDogbW9udGhUZW1wbGF0ZSxcbiAgICAgICAgd2Vlazogd2Vla1RlbXBsYXRlLFxuICAgICAgICBkYXk6IGRheVRlbXBsYXRlLFxuICAgIH07XG5cbiAgICBjb25zdCBkaXJlY3RpdmUgPSB7XG4gICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgIHNjb3BlOiB7fSxcbiAgICAgICAgYmluZFRvQ29udHJvbGxlcjoge1xuICAgICAgICAgICAgYmNTdGFydERhdGU6ICdAPycsICAgICAgICAvLyBkYXRlIC0gZGVmYXVsdCB0byB0b2RheVxuICAgICAgICAgICAgYmNFbmREYXRlOiAnQD8nLCAgICAgICAgICAvLyBkYXRlIC0gaWYgbm90IHByZXNlbnQsIHVzZSBjcmVhdGUgdXNpbmcgYmNEYXlzXG4gICAgICAgICAgICBiY05lc3RpbmdEZXB0aDogJ0A/JywgICAgIC8vIHN0cmluZyBbbW9udGh8d2Vla3xkYXldIC0gZGVmYXVsdHM6IG1vbnRoXG4gICAgICAgICAgICBiY0RheXM6ICdAPycsICAgICAgICAgICAgIC8vIGludGVnZXIgLSBkZWZhdWx0IHRvIDMwICh1c2VkIHRvIGNyZWF0ZSBiY0VuZERhdGUpXG4gICAgICAgICAgICBiY0RheVRpdGxlRm9ybWF0OiAnQD8nLCAgIC8vIHN0cmluZyBbd29yZHxhYmJyZXZpYXRpb258bGV0dGVyXSAtIGRlZmF1bHQ6IGFiYnJldmlhdGlvblxuICAgICAgICAgICAgYmNNb250aFRpdGxlRm9ybWF0OiAnQD8nLCAvLyBzdHJpbmcgLSBhbnkgdmFsaWQgTW9tZW50IGRhdGUgZm9ybWF0IC0gZGVmYXVsdDogTU1NTVxuICAgICAgICAgICAgYmNEYXRlU2VsZWN0ZWQ6ICcmJywgICAgICAvLyBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCB3aGVuIGEgZGF0ZSBpcyBzZWxlY3RlZCAodGFwL2NsaWNrKVxuICAgICAgICAgICAgYmNTaG93V2Vla2RheXM6ICc9PycsICAgICAvLyBkZXRlcm1pbmUgaWYgdGhlIHdlZWtkYXlzIGhlYWRlciBzaG91bGQgYmUgY3JlYXRlZFxuICAgICAgICAgICAgYmNTaG93TW9udGhUaXRsZXM6ICc9PycsICAvLyBkZXRlcm1pbmUgaWYgdGhlIG1vbnRoIHRpdGxlcyBzaG91bGQgYmUgdmlzaWJsZVxuICAgICAgICAgICAgYmNEYXlUZW1wbGF0ZTogJ0A/JywgICAgICAvLyBvdmVyd3JpdGUgdGhlIGRlZmF1bHQgJ2RheScgdGVtcGxhdGVcbiAgICAgICAgICAgIGJjRGF0ZUZvcm1hdDogJ0A/JywgICAgICAgLy8gZGVmaW5lIGEgY3VzdG9tIGRhdGUgZm9ybWF0IGZvciB0aGUgZGF5XG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGxpbmtGdW5jdGlvbixcbiAgICAgICAgdGVtcGxhdGVVcmw6IGNhbGVuZGFyVGVtcGxhdGUsXG4gICAgICAgIGNvbnRyb2xsZXI6IENhbGVuZGFyQ29udHJvbGxlcixcbiAgICAgICAgY29udHJvbGxlckFzOiAnJGN0cmwnLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG5cblxuXG4gICAgLyoqXG4gICAgICogTGlua1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxpbmtGdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICRjdHJsKSB7XG5cbiAgICAgICAgLy8gU2V0IHRoZSBjb3JyZWN0IHRlbXBsYXRlIGJhc2VkIG9uIHRoZSBkZXNpcmVkIG5lc3RpbmcgZGVwdGhcbiAgICAgICAgJGN0cmwuZ2V0VGVtcGxhdGVVcmwgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdGVtcGxhdGVzWyRjdHJsLm5lc3RpbmdEZXB0aF07XG4gICAgICAgIH07XG5cbiAgICB9XG5cblxuXG59XG5cblxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvY2FsZW5kYXIuZGlyZWN0aXZlLmpzXG4gKiovIiwiZXhwb3J0IGNsYXNzIENhbGVuZGFyQ29udHJvbGxlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgJHRlbXBsYXRlQ2FjaGUsXG4gICAgICAgIGJjQ2FsZW5kYXJDb25maWcsIGJjQ2FsZW5kYXJTZXJ2aWNlXG4gICAgKSB7XG4gICAgICAgICduZ0luamVjdCc7XG5cbiAgICAgICAgdGhpcy4kdGVtcGxhdGVDYWNoZSA9ICR0ZW1wbGF0ZUNhY2hlO1xuICAgICAgICB0aGlzLmJjQ2FsZW5kYXJDb25maWcgPSBiY0NhbGVuZGFyQ29uZmlnO1xuICAgICAgICB0aGlzLmJjQ2FsZW5kYXJTZXJ2aWNlID0gYmNDYWxlbmRhclNlcnZpY2U7XG5cblxuICAgICAgICB0aGlzLl9hY3RpdmF0ZSgpO1xuXG4gICAgfVxuXG5cblxuXG4gICAgX2FjdGl2YXRlKCkge1xuICAgICAgICAvLyBEZWZpbmUgdG9kYXkncyBkYXRlXG4gICAgICAgIHRoaXMudG9kYXkgPSBtb21lbnQobmV3IERhdGUoKSkuc3RhcnRPZignZGF5Jyk7XG5cbiAgICAgICAgLy8gRGVmaW5lIHRoZSBzdGFydCBkYXRlIGZvciB0aGUgY2FsZW5kYXJcbiAgICAgICAgdGhpcy5zdGFydERhdGUgPSB0aGlzLmJjU3RhcnREYXRlIHx8IHRoaXMuYmNDYWxlbmRhckNvbmZpZy5zdGFydERhdGU7XG5cbiAgICAgICAgLy8gSWYgdGhlIGVuZCBkYXRlIHdhcyBkZWZpbmVkXG4gICAgICAgIGlmICh0aGlzLmJjRW5kRGF0ZSkge1xuXG4gICAgICAgICAgICAvLyBEZWZpbmUgaG93IG1hbnkgZGF5cyBhcmUgbmVlZGVkIHVzaW5nIHRoZSBlbmQgZGF0ZVxuICAgICAgICAgICAgdGhpcy5kYXlzID0gdGhpcy5iY0NhbGVuZGFyU2VydmljZS5kdXJhdGlvbkluRGF5cyh0aGlzLnN0YXJ0RGF0ZSwgdGhpcy5iY0VuZERhdGUpO1xuXG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIC8vIERlZmluZSBob3cgbWFueSBkYXlzIGFyZSBuZWVkZWQgZnJvbSB0aGUgY291bnQgcGFzc2VkIGluIG9yIHRoZSBjb25maWdcbiAgICAgICAgICAgIHRoaXMuZGF5cyA9IHBhcnNlSW50KHRoaXMuYmNEYXlzIHx8IHRoaXMuYmNDYWxlbmRhckNvbmZpZy5kYXlzLCAxMCk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlZmluZSBob3cgZGVlcCB0byBvcmdhbml6ZSB0aGUgY2FsZW5kYXJcbiAgICAgICAgdGhpcy5uZXN0aW5nRGVwdGggPSB0aGlzLmJjTmVzdGluZ0RlcHRoIHx8IHRoaXMuYmNDYWxlbmRhckNvbmZpZy5uZXN0aW5nRGVwdGg7XG5cbiAgICAgICAgLy8gRGVmaW5lIHRoZSB3ZWVrZGF5IGhlYWRlcnMgZm9ybWF0XG4gICAgICAgIHRoaXMud2Vla2RheXMgPSB0aGlzLmJjRGF5VGl0bGVGb3JtYXQgP1xuICAgICAgICAgICAgdGhpcy5iY0NhbGVuZGFyQ29uZmlnLndlZWtkYXlTdHlsZVt0aGlzLmJjRGF5VGl0bGVGb3JtYXRdIDpcbiAgICAgICAgICAgIHRoaXMuYmNDYWxlbmRhckNvbmZpZy53ZWVrZGF5U3R5bGVbdGhpcy5iY0NhbGVuZGFyQ29uZmlnLmRheVRpdGxlRm9ybWF0XTtcblxuICAgICAgICAvLyBEZWZpbmUgdGhlIGZvcm1hdCBmb3IgdGhlIG1vbnRoIHRpdGxlXG4gICAgICAgIHRoaXMubW9udGhUaXRsZUZvcm1hdCA9IHRoaXMuYmNNb250aFRpdGxlRm9ybWF0IHx8IHRoaXMuYmNDYWxlbmRhckNvbmZpZy5tb250aFRpdGxlRm9ybWF0O1xuXG4gICAgICAgIC8vIERlZmluZSBpZiBtb250aCB0aXRsZXMgc2hvdWxkIGJlIHZpc2libGVcbiAgICAgICAgdGhpcy5zaG93TW9udGhUaXRsZXMgPSB0eXBlb2YodGhpcy5iY1Nob3dNb250aFRpdGxlcykgPT09ICdib29sZWFuJyA/XG4gICAgICAgICAgICB0aGlzLmJjU2hvd01vbnRoVGl0bGVzIDogdGhpcy5iY0NhbGVuZGFyQ29uZmlnLnNob3dNb250aFRpdGxlcztcblxuICAgICAgICAvLyBJbml0aWFsbHkgbm8gZGF0ZSBpcyBzZWxlY3RlZFxuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZSA9IG51bGw7XG5cbiAgICAgICAgLy8gU2V0IHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBjYWxlbmRhciB3ZWVrZGF5cyBoZWFkZXJzXG4gICAgICAgIHRoaXMuc2hvd1dlZWtkYXlzID0gdHlwZW9mKHRoaXMuYmNTaG93V2Vla2RheXMpID09PSAnYm9vbGVhbicgP1xuICAgICAgICAgICAgdGhpcy5iY1Nob3dXZWVrZGF5cyA6IHRoaXMuYmNDYWxlbmRhckNvbmZpZy5zaG93V2Vla2RheXM7XG5cblxuICAgICAgICAvLyBJZiBhIGN1c3RvbSBkYXkgdGVtcGxhdGUgaGFzIGJlZW4gc2V0IGluIGVpdGhlciBsb2NhdGlvbiAoYXR0cmlidXRlIG9yIHByb3ZpZGVyKVxuICAgICAgICBpZiAodGhpcy5iY0RheVRlbXBsYXRlIHx8IHRoaXMuYmNDYWxlbmRhckNvbmZpZy51c2VyRGF5VGVtcGxhdGUpIHtcbiAgICAgICAgICAgIC8vIE5hbWUgdGhlIHRlbXBsYXRlIGxvY2F0aW9uXG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZUxvY2F0aW9uID0gJ3VzZXJEYXlUZW1wbGF0ZS5odG1sJztcblxuICAgICAgICAgICAgLy8gSWYgdGhlIHVzZXIgc2V0IGEgdGVtcGxhdGUgdmlhIHRoZSBkaXJlY3RpdmUgYXR0cmlidXRlXG4gICAgICAgICAgICBpZiAodGhpcy5iY0RheVRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgLy8gUHV0IHRoZSB1c2VyIHRlbXBsYXRlIGludG8gdGhlIGNhY2hlXG4gICAgICAgICAgICAgICAgdGhpcy4kdGVtcGxhdGVDYWNoZS5wdXQodGVtcGxhdGVMb2NhdGlvbiwgdGhpcy5iY0RheVRlbXBsYXRlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSWYgdGhlIHVzZXIgZGVmaW5lZCBhIHRlbXBsYXRlIHVzaW5nIHRoZSBwcm92aWRlclxuICAgICAgICAgICAgaWYgKHRoaXMuYmNDYWxlbmRhckNvbmZpZy51c2VyRGF5VGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICAvLyBQdXQgdGhlIHVzZXIgdGVtcGxhdGUgaW50byB0aGUgY2FjaGVcbiAgICAgICAgICAgICAgICB0aGlzLiR0ZW1wbGF0ZUNhY2hlLnB1dCh0ZW1wbGF0ZUxvY2F0aW9uLCB0aGlzLmJjQ2FsZW5kYXJDb25maWcudXNlckRheVRlbXBsYXRlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIGlubmVyLWRheSB0ZW1wbGF0ZSBvbiB0aGUgc2VydmljZVxuICAgICAgICAgICAgdGhpcy5iY0NhbGVuZGFyU2VydmljZS5zdG9yZURheVRlbXBsYXRlKHRlbXBsYXRlTG9jYXRpb24pO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBObyBjdXN0b20gdGVtcGxhdGUgd2FzIGRlZmluZWRcblxuICAgICAgICAgICAgLy8gU3RvcmUgdGhlIGlubmVyLWRheSB0ZW1wbGF0ZSBvbiB0aGUgc2VydmljZVxuICAgICAgICAgICAgdGhpcy5iY0NhbGVuZGFyU2VydmljZS5zdG9yZURheVRlbXBsYXRlKHRoaXMuYmNDYWxlbmRhckNvbmZpZy5kYXlUZW1wbGF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWZpbmUgdGhlIGRhdGUgZm9ybWF0IGZvciB0aGUgaW5kaXZpZHVhbCBkYXlcbiAgICAgICAgdGhpcy5kYXRlRm9ybWF0ID0gdGhpcy5iY0RhdGVGb3JtYXQgfHwgdGhpcy5iY0NhbGVuZGFyQ29uZmlnLmRhdGVGb3JtYXQ7XG5cbiAgICAgICAgLy8gQnVpbGQgYXJyYXkgb2YgZGF5c1xuICAgICAgICBjb25zdCBkYXlzID0gdGhpcy5iY0NhbGVuZGFyU2VydmljZS5idWlsZERheXModGhpcy5kYXlzLCB0aGlzLnN0YXJ0RGF0ZSk7XG5cbiAgICAgICAgLy8gQnVpbGQgdGhlIGNhbGVuZGFyIEpTT04gYW5kIGV4cG9zZSB0byB0aGUgRE9NXG4gICAgICAgIHRoaXMuX2J1aWxkQ2FsZW5kYXIoZGF5cywgdGhpcy5uZXN0aW5nRGVwdGgpO1xuXG4gICAgfVxuXG5cblxuXG5cbiAgICAvKipcbiAgICAgKiBDaGVjayB0byBzZWUgaWYgdGhlIGRheSBpcyBwcmlvciB0byB0aGUgY3VycmVudCBkYXRlXG4gICAgICogVGhpcyBpcyB1c2VkIHRvIGRpc2FibGUgdGhlIHVuc2VsZWN0YWJsZSBkYXlzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0RhdGV9IGRhdGVcbiAgICAgKiBAcmV0dXJuIHtCb29sfVxuICAgICAqL1xuICAgIGlzQmVmb3JlVG9kYXkoZGF0ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5iY0NhbGVuZGFyU2VydmljZS5kYXRlSXNCZWZvcmVUb2RheShkYXRlKTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIENoZWNrIHRvIHNlZSBpZiB0aGUgZGF5IG1hdGNoZXMgdGhlIGN1cnJlbnQgZGF0ZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtEYXRlfSBkYXRlXG4gICAgICogQHJldHVybiB7Qm9vbH1cbiAgICAgKi9cbiAgICBpc0RheVRvZGF5KGRhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmNDYWxlbmRhclNlcnZpY2UuaXNEYXlUb2RheShkYXRlLCB0aGlzLnN0YXJ0RGF0ZSk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBTZWxlY3QgYSBkYXRlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF5XG4gICAgICovXG4gICAgc2VsZWN0RGF0ZShkYXkpIHtcbiAgICAgICAgLy8gU2V0IHRoZSBzZWxlY3RlZCBkYXlcbiAgICAgICAgdGhpcy5zZWxlY3RlZERhdGUgPSBkYXk7XG5cbiAgICAgICAgLy8gT25seSBjYWxsIHRoZSBwYXNzZWQgbWV0aG9kIGlmIGl0IGV4aXN0cyBhbmQgYSB2YWxpZCBkYXRlIHdhcyBjaG9zZW5cbiAgICAgICAgaWYgKGRheS5kYXRlICYmIHRoaXMuYmNEYXRlU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuYmNEYXRlU2VsZWN0ZWQoe1xuICAgICAgICAgICAgICAgIGRhdGU6IGRheS5kYXRlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEZvcm1hdCBhIGRhdGUgdXNpbmcgbW9tZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBmb3JtYXRcbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IGZvcm1hdHRlZERhdGVcbiAgICAgKi9cbiAgICBmb3JtYXREYXRlKGRhdGUsIGZvcm1hdCkge1xuICAgICAgICBpZiAoIWRhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtb21lbnQoZGF0ZSkuZm9ybWF0KGZvcm1hdCk7XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBCdWlsZCB0aGUgY2FsZW5kYXIgSlNPTlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcnJheX0gZGF5c1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkZXB0aFxuICAgICAqIEByZXR1cm4ge0VsZW1lbnR9IGVsZW1lbnRcbiAgICAgKi9cbiAgICBfYnVpbGRDYWxlbmRhcihkYXlzLCBkZXB0aCkge1xuXG4gICAgICAgIC8vIENhbGwgdGhlIGNvcnJlY3Qgb3JnYW5pemF0aW9uIG1ldGhvZCBiYXNlZCBvbiB0aGUgbmVzdGluZyBkZXB0aFxuICAgICAgICBpZiAoZGVwdGggPT09ICdtb250aCcpIHtcblxuICAgICAgICAgICAgdGhpcy5iY0NvbGxlY3Rpb24gPSB0aGlzLmJjQ2FsZW5kYXJTZXJ2aWNlLm9yZ2FuaXplTW9udGhzKGRheXMpO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoZGVwdGggPT09ICd3ZWVrJykge1xuXG4gICAgICAgICAgICB0aGlzLmJjQ29sbGVjdGlvbiA9IHRoaXMuYmNDYWxlbmRhclNlcnZpY2Uub3JnYW5pemVXZWVrcyhkYXlzKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGRlcHRoID09PSAnZGF5Jykge1xuXG4gICAgICAgICAgICB0aGlzLmJjQ29sbGVjdGlvbiA9IGRheXM7XG5cbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NhbGVuZGFyLmNvbnRyb2xsZXIuanNcbiAqKi8iLCJ2YXIgcGF0aCA9ICcvVXNlcnMvYmMvQ29kZS9vcGVuLXNvdXJjZS9hbmd1bGFyLWpzb24tY2FsZW5kYXIvc3JjL3RlbXBsYXRlcy9jYWxlbmRhci5odG1sJztcbnZhciBodG1sID0gXCI8c2VjdGlvbiBjbGFzcz1iYy1jYWxlbmRhcj4gPHNwYW4gY2xhc3M9YmMtY2FsZW5kYXJfX3dlZWtkYXlzIGRhdGEtbmctaWY9XFxcIiRjdHJsLnNob3dXZWVrZGF5cyAmJiAkY3RybC5uZXN0aW5nRGVwdGggPT09ICd3ZWVrJ1xcXCI+IDxzcGFuIGNsYXNzPVxcXCJiYy1jYWxlbmRhcl9fZGF5IGJjLWNhbGVuZGFyX19kYXktLXdlZWtkYXlzXFxcIiBkYXRhLW5nLXJlcGVhdD1cXFwiZGF5IGluICRjdHJsLndlZWtkYXlzIHRyYWNrIGJ5ICRpbmRleFxcXCI+IDxzdHJvbmcgY2xhc3M9YmMtY2FsZW5kYXJfX2RheS10aXRsZT4ge3sgZGF5IH19IDwvc3Ryb25nPiA8L3NwYW4+IDwvc3Bhbj4gPGJjLW1vbnRoIGRhdGEtbmctaWY9XFxcIiRjdHJsLm5lc3RpbmdEZXB0aCA9PT0gJ21vbnRoJ1xcXCIgY2xhc3M9YmMtY2FsZW5kYXJfX21vbnRoLXdyYXBwZXIgYmMtY29sbGVjdGlvbj0kY3RybC5iY0NvbGxlY3Rpb24+PC9iYy1tb250aD4gPGJjLXdlZWsgZGF0YS1uZy1pZj1cXFwiJGN0cmwubmVzdGluZ0RlcHRoID09PSAnd2VlaydcXFwiIGNsYXNzPWJjLWNhbGVuZGFyX193ZWVrLXdyYXBwZXIgYmMtY29sbGVjdGlvbj0kY3RybC5iY0NvbGxlY3Rpb24+PC9iYy13ZWVrPiA8YmMtZGF5IGRhdGEtbmctaWY9XFxcIiRjdHJsLm5lc3RpbmdEZXB0aCA9PT0gJ2RheSdcXFwiIGNsYXNzPWJjLWNhbGVuZGFyX19kYXktd3JhcHBlciBiYy1jb2xsZWN0aW9uPSRjdHJsLmJjQ29sbGVjdGlvbj48L2JjLWRheT4gPC9zZWN0aW9uPlwiO1xud2luZG93LmFuZ3VsYXIubW9kdWxlKCduZycpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oYykgeyBjLnB1dChwYXRoLCBodG1sKSB9XSk7XG5tb2R1bGUuZXhwb3J0cyA9IHBhdGg7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy90ZW1wbGF0ZXMvY2FsZW5kYXIuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMCAxXG4gKiovIiwidmFyIHBhdGggPSAnL1VzZXJzL2JjL0NvZGUvb3Blbi1zb3VyY2UvYW5ndWxhci1qc29uLWNhbGVuZGFyL3NyYy90ZW1wbGF0ZXMvbW9udGguaHRtbCc7XG52YXIgaHRtbCA9IFwiPHRpbWUgY2xhc3M9YmMtY2FsZW5kYXJfX21vbnRoIGRhdGV0aW1lPVxcXCJ7eyBtb250aFswXVttb250aFswXS5sZW5ndGggLSAxXS5kYXRlIHwgZGF0ZToneXl5eS1NTScgfX1cXFwiIGRhdGEtbmctcmVwZWF0PVxcXCJtb250aCBpbiB2bS5iY0NvbGxlY3Rpb24gdHJhY2sgYnkgJGluZGV4XFxcIj4gPHNwYW4gY2xhc3M9YmMtY2FsZW5kYXJfX21vbnRoLXRpdGxlIGRhdGEtbmctYmluZD1cXFwiJGN0cmwuZm9ybWF0RGF0ZShtb250aFswXVttb250aFswXS5sZW5ndGggLSAxXS5kYXRlLCAkY3RybC5tb250aFRpdGxlRm9ybWF0KVxcXCIgZGF0YS1uZy1pZj0kY3RybC5zaG93TW9udGhUaXRsZXM+PC9zcGFuPiA8c3BhbiBjbGFzcz1iYy1jYWxlbmRhcl9fd2Vla2RheXMgZGF0YS1uZy1pZj0kY3RybC5zaG93V2Vla2RheXM+IDxzcGFuIGNsYXNzPVxcXCJiYy1jYWxlbmRhcl9fZGF5IGJjLWNhbGVuZGFyX19kYXktLXdlZWtkYXlzXFxcIiBkYXRhLW5nLXJlcGVhdD1cXFwiZGF5IGluICRjdHJsLndlZWtkYXlzIHRyYWNrIGJ5ICRpbmRleFxcXCI+IDxzdHJvbmcgY2xhc3M9YmMtY2FsZW5kYXJfX2RheS10aXRsZT4ge3sgZGF5IH19IDwvc3Ryb25nPiA8L3NwYW4+IDwvc3Bhbj4gPGJjLXdlZWsgYmMtY29sbGVjdGlvbj1tb250aCBjbGFzcz1iYy1jYWxlbmRhcl9fd2Vlay13cmFwcGVyPjwvYmMtd2Vlaz4gPC90aW1lPlwiO1xud2luZG93LmFuZ3VsYXIubW9kdWxlKCduZycpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oYykgeyBjLnB1dChwYXRoLCBodG1sKSB9XSk7XG5tb2R1bGUuZXhwb3J0cyA9IHBhdGg7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy90ZW1wbGF0ZXMvbW9udGguaHRtbFxuICoqIG1vZHVsZSBpZCA9IDdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMCAxXG4gKiovIiwidmFyIHBhdGggPSAnL1VzZXJzL2JjL0NvZGUvb3Blbi1zb3VyY2UvYW5ndWxhci1qc29uLWNhbGVuZGFyL3NyYy90ZW1wbGF0ZXMvd2Vlay5odG1sJztcbnZhciBodG1sID0gXCI8dGltZSBjbGFzcz1iYy1jYWxlbmRhcl9fd2VlayBkYXRldGltZT1cXFwie3sgd2Vla1t3ZWVrLmxlbmd0aCAtIDFdLmRhdGUgfCBkYXRlOid5eXl5LXd3JyB9fVxcXCIgZGF0YS1uZy1yZXBlYXQ9XFxcIndlZWsgaW4gdm0uYmNDb2xsZWN0aW9uIHRyYWNrIGJ5ICRpbmRleFxcXCI+IDxiYy1kYXkgYmMtY29sbGVjdGlvbj13ZWVrIGNsYXNzPWJjLWNhbGVuZGFyX19kYXktd3JhcHBlcj48L2JjLWRheT4gPC90aW1lPlwiO1xud2luZG93LmFuZ3VsYXIubW9kdWxlKCduZycpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oYykgeyBjLnB1dChwYXRoLCBodG1sKSB9XSk7XG5tb2R1bGUuZXhwb3J0cyA9IHBhdGg7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy90ZW1wbGF0ZXMvd2Vlay5odG1sXG4gKiogbW9kdWxlIGlkID0gOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwIDFcbiAqKi8iLCJ2YXIgcGF0aCA9ICcvVXNlcnMvYmMvQ29kZS9vcGVuLXNvdXJjZS9hbmd1bGFyLWpzb24tY2FsZW5kYXIvc3JjL3RlbXBsYXRlcy9kYXkuaHRtbCc7XG52YXIgaHRtbCA9IFwiPHNwYW4gY2xhc3M9YmMtY2FsZW5kYXJfX2RheSBkYXRhLW5nLWNsYXNzPVxcXCJ7ICdiYy1jYWxlbmRhcl9fZGF5LS1kaXNhYmxlZCc6ICRjdHJsLmlzQmVmb3JlVG9kYXkoZGF5LmRhdGUpLFxcbiAgICAgICAgICAgICAgICAgICAnYmMtY2FsZW5kYXJfX2RheS0tdG9kYXknOiAkY3RybC5pc0RheVRvZGF5KGRheS5kYXRlKSxcXG4gICAgICAgICAgICAgICAgICAgJ2JjLWNhbGVuZGFyX19kYXktLWV2ZW4nOiAkZXZlbixcXG4gICAgICAgICAgICAgICAgICAgJ2JjLWNhbGVuZGFyX19kYXktLW9kZCc6ICRvZGQsXFxuICAgICAgICAgICAgICAgICAgICdiYy1jYWxlbmRhcl9fZGF5LS1wYWQnOiAhZGF5LmRhdGUsXFxuICAgICAgICAgICAgICAgICAgICdiYy1jYWxlbmRhcl9fZGF5LS12YWxpZCc6IGRheS5kYXRlLFxcbiAgICAgICAgICAgICAgICAgICAnYmMtY2FsZW5kYXJfX2RheS0tc2VsZWN0ZWQnOiBkYXkuZGF0ZSA9PT0gJGN0cmwuc2VsZWN0ZWREYXRlLmRhdGUgfVxcXCIgZGF0YS1uZy1jbGljaz0kY3RybC5zZWxlY3REYXRlKGRheSkgZGF0YS1uZy1yZXBlYXQ9XFxcImRheSBpbiB2bS5iY0NvbGxlY3Rpb24gdHJhY2sgYnkgJGluZGV4XFxcIiB0aXRsZT1cXFwie3sgZGF5LmRhdGUgPyBkYXkuZGF0ZSA6ICcnIH19XFxcIiB0YWJpbmRleD1cXFwie3sgZGF5LmRhdGUgPyAxIDogLTEgfX1cXFwiPiA8bmctaW5jbHVkZSBzcmM9dm0uZGF5VGVtcGxhdGU+PC9uZy1pbmNsdWRlPiA8L3NwYW4+XCI7XG53aW5kb3cuYW5ndWxhci5tb2R1bGUoJ25nJykucnVuKFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbihjKSB7IGMucHV0KHBhdGgsIGh0bWwpIH1dKTtcbm1vZHVsZS5leHBvcnRzID0gcGF0aDtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc3JjL3RlbXBsYXRlcy9kYXkuaHRtbFxuICoqIG1vZHVsZSBpZCA9IDlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMCAxXG4gKiovIiwiaW1wb3J0IG1vbnRoVGVtcGxhdGUgZnJvbSAnLi90ZW1wbGF0ZXMvbW9udGguaHRtbCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBiY01vbnRoRGlyZWN0aXZlKFxuKSB7XG4gICAgJ25nSW5qZWN0JztcblxuICAgIGNvbnN0IGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHRydWUsXG4gICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcbiAgICAgICAgICAgIGJjQ29sbGVjdGlvbjogJz0nLFxuICAgICAgICAgICAgYmNXZWVrZGF5c0hlYWRlcjogJz0nLFxuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogbW9udGhUZW1wbGF0ZSxcbiAgICAgICAgY29udHJvbGxlcjogKCkgPT4ge30sXG4gICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxufVxuXG5cblxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvbW9udGguZGlyZWN0aXZlLmpzXG4gKiovIiwiaW1wb3J0IHdlZWtUZW1wbGF0ZSBmcm9tICcuL3RlbXBsYXRlcy93ZWVrLmh0bWwnO1xuXG5leHBvcnQgZnVuY3Rpb24gYmNXZWVrRGlyZWN0aXZlKFxuKSB7XG4gICAgJ25nSW5qZWN0JztcblxuICAgIGNvbnN0IGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgICAgc2NvcGU6IHRydWUsXG4gICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHtcbiAgICAgICAgICAgIGJjQ29sbGVjdGlvbjogJz0nLFxuICAgICAgICB9LFxuICAgICAgICB0ZW1wbGF0ZVVybDogd2Vla1RlbXBsYXRlLFxuICAgICAgICBjb250cm9sbGVyOiAoKSA9PiB7fSxcbiAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3dlZWsuZGlyZWN0aXZlLmpzXG4gKiovIiwiaW1wb3J0IGRheVdyYXBwZXJUZW1wbGF0ZSBmcm9tICcuL3RlbXBsYXRlcy9kYXkuaHRtbCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBiY0RheURpcmVjdGl2ZShcbiAgICBiY0NhbGVuZGFyQ29uZmlnXG4pIHtcbiAgICAnbmdJbmplY3QnO1xuXG4gICAgY29uc3QgZGlyZWN0aXZlID0ge1xuICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICBzY29wZTogdHJ1ZSxcbiAgICAgICAgYmluZFRvQ29udHJvbGxlcjoge1xuICAgICAgICAgICAgYmNDb2xsZWN0aW9uOiAnPScsXG4gICAgICAgIH0sXG4gICAgICAgIHRlbXBsYXRlVXJsOiBkYXlXcmFwcGVyVGVtcGxhdGUsXG4gICAgICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uKGJjQ2FsZW5kYXJTZXJ2aWNlKSB7XG4gICAgICAgICAgICAnbmdJbmplY3QnO1xuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGlubmVyLWRheSB0ZW1wbGF0ZSBmcm9tIHRoZSBzZXJ2aWNlXG4gICAgICAgICAgICB0aGlzLmRheVRlbXBsYXRlID0gYmNDYWxlbmRhclNlcnZpY2UuZ2V0RGF5VGVtcGxhdGUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgIH07XG5cbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG59XG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2RheS5kaXJlY3RpdmUuanNcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9